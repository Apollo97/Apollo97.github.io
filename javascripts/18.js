(window.webpackJsonp=window.webpackJsonp||[]).push([[18],{328:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "GlobalVar", function() { return GlobalVar; });\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "$gv", function() { return $gv; });\n/* harmony import */ var _public_javascripts_resource_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(346);\n/* harmony import */ var _IRenderer_js__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(332);\n/* harmony import */ var _Engine_js__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(335);\n/* harmony import */ var _math_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(333);\n/* harmony import */ var _Physics_DebugDraw_js__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(370);\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\nclass GlobalVar {\r\n\tconstructor() {\r\n\t\tlet isMobile = /iPhone|iPad|iPod|Android/i.test(navigator.userAgent);\r\n\t\tif (isMobile) {\r\n\t\t\tthis.is_mobile = true;\r\n\t\t}\r\n\r\n\t\tif (isMobile) {\r\n\t\t\tthis.m_is_run = false;\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis.m_is_run = true;\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tthis.MAX_FPS = 60;\r\n\t\t\tthis.FRAME_ELAPSED = 1000 / 60;\r\n\t\t\tthis.CANVAS_SCALE = 32;\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tif (true) {\r\n\t\t\t\tthis.m_editor_mode = false;\r\n\r\n\t\t\t\tthis.m_display_foothold = false;\r\n\r\n\t\t\t\tthis.m_display_physics_debug = false;\r\n\t\t\t}\r\n\t\t\telse {}\r\n\t\t\tthis.m_display_debug_info = false;\r\n\r\n\t\t\tthis.m_debugDraw = new _Physics_DebugDraw_js__WEBPACK_IMPORTED_MODULE_4__[/* default */ "a"](/*renderer_ctx2d*/);\r\n\r\n\t\t\tthis.m_display_selected_object = false;\r\n\t\t\tthis.m_selected_object = null;\r\n\t\t\tthis.m_hover_object = null;\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tthis.m_viewRect = new _math_js__WEBPACK_IMPORTED_MODULE_3__["Rectangle"](0, -768 / 2, 1366, 768);\r\n\r\n\t\t\tif (true) {\r\n\t\t\t\tthis.m_is_rendering_map = true;\r\n\t\t\t}\r\n\t\t\telse {}\r\n\r\n\t\t\tif (true) {\r\n\t\t\t\tthis.m_display_back = true;\r\n\t\t\t\tthis.m_display_front = true;\r\n\t\t\t\tthis.m_display_mapobj = true;\r\n\t\t\t\tthis.m_display_maptile = true;\r\n\t\t\t\tthis.m_display_particle_system = true;\r\n\r\n\t\t\t\tthis.m_display_skeletal_anim = true;\r\n\t\t\t}\r\n\t\t\telse {}\r\n\r\n\t\t\tthis.m_display_portal = true;\r\n\r\n\t\t\tif (true) {\r\n\t\t\t\tthis.m_display_name_label = true;\r\n\t\t\t}\r\n\t\t\telse {}\r\n\r\n\t\t\tthis.m_display_player = true;\r\n\t\t\tthis.m_display_other_player = true;\r\n\t\t\tthis.m_display_life = true;\r\n\t\t\tthis.m_display_npc = true;//??\r\n\t\t\tthis.m_display_mob = true;//??\r\n\r\n\t\t\t//this.m_display_skill;\r\n\t\t\t//this.m_display_mob_skill;\r\n\t\t\t//this.m_display_mob_effect = true;\r\n\t\t\t//this.m_display_mob_etc = true;\r\n\t\t}\r\n\t\t\r\n\t\t{\r\n\t\t\tthis.NameLabel_default_style = "214";\r\n\r\n\t\t\tthis.ChatBalloon_default_style = "212";\r\n\t\t\tthis.ChatBalloon_display_duration = 5000;\r\n\t\t}\r\n\t\t\r\n\t\t{\r\n\t\t\tthis.input_keyDown = {};\r\n\t\t\tthis.input_keyUp = {};\r\n\r\n\t\t\tthis.mouse_move = 0;\r\n\t\t\tthis.mouse_x = 0;\r\n\t\t\tthis.mouse_y = 0;\r\n\t\t\tthis.mouse_dl = 0;\r\n\t\t\tthis.mouse_ul = 0;\r\n\t\t\tthis.mouse_dm = 0;\r\n\t\t\tthis.mouse_um = 0;\r\n\t\t\tthis.mouse_dr = 0;\r\n\t\t\tthis.mouse_ur = 0;\r\n\t\t}\r\n\r\n\t\t{\r\n\t\t\tlet SceneObjectMgr = {};\r\n\r\n\t\t\tSceneObjectMgr.layeredObjects = [];\r\n\t\t\tfor (let i = 0; i < 12; ++i) {\r\n\t\t\t\tlet lo = SceneObjectMgr.layeredObjects[i] = {};\r\n\t\t\t\tObject.defineProperty(lo, "length", {\r\n\t\t\t\t\tenumerable: false,\r\n\t\t\t\t\twritable: true,\r\n\t\t\t\t\tvalue: 0,\r\n\t\t\t\t});\r\n\t\t\t}\r\n\r\n\t\t\tSceneObjectMgr.Update = function (stamp) {\r\n\t\t\t\tfor (let layer = 0; layer < SceneObjectMgr.layeredObjects.length; ++layer) {\r\n\t\t\t\t\tconst lo = SceneObjectMgr.layeredObjects[layer];\r\n\t\t\t\t\tfor (let uid in lo) {\r\n\t\t\t\t\t\tlet obj = lo[uid];\r\n\t\t\t\t\t\tobj.update(stamp);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tSceneObjectMgr.RenderLayer = function (engine, layer) {\r\n\t\t\t\tconst lo = SceneObjectMgr.layeredObjects[layer];\r\n\t\t\t\tfor (let uid in lo) {\r\n\t\t\t\t\tlet obj = lo[uid];\r\n\t\t\t\t\tobj.render(engine);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tSceneObjectMgr.addToScene = function (layer, obj) {\r\n\t\t\t\tif (Number.isSafeInteger(layer) && layer in SceneObjectMgr.layeredObjects) {\r\n\t\t\t\t\tconst lo = SceneObjectMgr.layeredObjects[layer];\r\n\r\n\t\t\t\t\tobj.$layer = layer;\r\n\t\t\t\t\tobj.$objectid = lo.length;\r\n\r\n\t\t\t\t\tlo[obj.$objectid] = obj;\r\n\r\n\t\t\t\t\tlo.length++;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthrow new TypeError("layer");\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\tSceneObjectMgr.destroy = function (obj) {\r\n\t\t\t\tconst layer = obj.$layer;\r\n\t\t\t\tconst uid = obj.$objectid;\r\n\t\t\t\tconst lo = SceneObjectMgr.layeredObjects[layer];\r\n\r\n\t\t\t\tobj.destroy();\r\n\r\n\t\t\t\tdelete lo[uid];\r\n\t\t\t}\r\n\r\n\t\t\tthis.SceneObjectMgr = SceneObjectMgr;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nconst $gv = new GlobalVar();\r\n\r\nwindow.$gv = $gv;\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiMzI4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL2dhbWUvaW5pdC5qcz9lOGI2Il0sInNvdXJjZXNDb250ZW50IjpbIu+7v1xyXG5cclxuaW1wb3J0IHsgfSBmcm9tICcuLi8uLi9wdWJsaWMvamF2YXNjcmlwdHMvcmVzb3VyY2UuanMnO1xyXG5cclxuaW1wb3J0IHsgSUdyYXBoIH0gZnJvbSBcIi4vSVJlbmRlcmVyLmpzXCI7XHJcbmltcG9ydCB7IGVuZ2luZSB9IGZyb20gJy4vRW5naW5lLmpzJztcclxuaW1wb3J0IHsgVmVjMiwgUmVjdGFuZ2xlIH0gZnJvbSAnLi9tYXRoLmpzJztcclxuaW1wb3J0IERlYnVnRHJhdyBmcm9tICcuL1BoeXNpY3MvRGVidWdEcmF3LmpzJztcclxuXHJcbmV4cG9ydCBjbGFzcyBHbG9iYWxWYXIge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0bGV0IGlzTW9iaWxlID0gL2lQaG9uZXxpUGFkfGlQb2R8QW5kcm9pZC9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcblx0XHRpZiAoaXNNb2JpbGUpIHtcclxuXHRcdFx0dGhpcy5pc19tb2JpbGUgPSB0cnVlO1xyXG5cdFx0fVxyXG5cclxuXHRcdGlmIChpc01vYmlsZSkge1xyXG5cdFx0XHR0aGlzLm1faXNfcnVuID0gZmFsc2U7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0dGhpcy5tX2lzX3J1biA9IHRydWU7XHJcblx0XHR9XHJcblxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLk1BWF9GUFMgPSA2MDtcclxuXHRcdFx0dGhpcy5GUkFNRV9FTEFQU0VEID0gMTAwMCAvIDYwO1xyXG5cdFx0XHR0aGlzLkNBTlZBU19TQ0FMRSA9IDMyO1xyXG5cdFx0fVxyXG5cclxuXHRcdHtcclxuXHRcdFx0aWYgKHByb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicpIHtcclxuXHRcdFx0XHR0aGlzLm1fZWRpdG9yX21vZGUgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfZm9vdGhvbGQgPSBmYWxzZTtcclxuXHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfcGh5c2ljc19kZWJ1ZyA9IGZhbHNlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMubV9lZGl0b3JfbW9kZSA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHR0aGlzLm1fZGlzcGxheV9mb290aG9sZCA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHR0aGlzLm1fZGlzcGxheV9waHlzaWNzX2RlYnVnID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHR0aGlzLm1fZGlzcGxheV9kZWJ1Z19pbmZvID0gZmFsc2U7XHJcblxyXG5cdFx0XHR0aGlzLm1fZGVidWdEcmF3ID0gbmV3IERlYnVnRHJhdygvKnJlbmRlcmVyX2N0eDJkKi8pO1xyXG5cclxuXHRcdFx0dGhpcy5tX2Rpc3BsYXlfc2VsZWN0ZWRfb2JqZWN0ID0gZmFsc2U7XHJcblx0XHRcdHRoaXMubV9zZWxlY3RlZF9vYmplY3QgPSBudWxsO1xyXG5cdFx0XHR0aGlzLm1faG92ZXJfb2JqZWN0ID0gbnVsbDtcclxuXHRcdH1cclxuXHJcblx0XHR7XHJcblx0XHRcdHRoaXMubV92aWV3UmVjdCA9IG5ldyBSZWN0YW5nbGUoMCwgLTc2OCAvIDIsIDEzNjYsIDc2OCk7XHJcblxyXG5cdFx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xyXG5cdFx0XHRcdHRoaXMubV9pc19yZW5kZXJpbmdfbWFwID0gdHJ1ZTtcclxuXHRcdFx0fVxyXG5cdFx0XHRlbHNlIHtcclxuXHRcdFx0XHR0aGlzLm1faXNfcmVuZGVyaW5nX21hcCA9IHRydWU7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfYmFjayA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfZnJvbnQgPSB0cnVlO1xyXG5cdFx0XHRcdHRoaXMubV9kaXNwbGF5X21hcG9iaiA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfbWFwdGlsZSA9IHRydWU7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfcGFydGljbGVfc3lzdGVtID0gdHJ1ZTtcclxuXHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfc2tlbGV0YWxfYW5pbSA9IHRydWU7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfYmFjayA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMubV9kaXNwbGF5X2Zyb250ID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfbWFwb2JqID0gZmFsc2U7XHJcblx0XHRcdFx0dGhpcy5tX2Rpc3BsYXlfbWFwdGlsZSA9IGZhbHNlO1xyXG5cdFx0XHRcdHRoaXMubV9kaXNwbGF5X3BhcnRpY2xlX3N5c3RlbSA9IGZhbHNlO1xyXG5cclxuXHRcdFx0XHR0aGlzLm1fZGlzcGxheV9za2VsZXRhbF9hbmltID0gZmFsc2U7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdHRoaXMubV9kaXNwbGF5X3BvcnRhbCA9IHRydWU7XHJcblxyXG5cdFx0XHRpZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgPT09ICdwcm9kdWN0aW9uJykge1xyXG5cdFx0XHRcdHRoaXMubV9kaXNwbGF5X25hbWVfbGFiZWwgPSB0cnVlO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdHRoaXMubV9kaXNwbGF5X25hbWVfbGFiZWwgPSBmYWxzZTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5tX2Rpc3BsYXlfcGxheWVyID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5tX2Rpc3BsYXlfb3RoZXJfcGxheWVyID0gdHJ1ZTtcclxuXHRcdFx0dGhpcy5tX2Rpc3BsYXlfbGlmZSA9IHRydWU7XHJcblx0XHRcdHRoaXMubV9kaXNwbGF5X25wYyA9IHRydWU7Ly8/P1xyXG5cdFx0XHR0aGlzLm1fZGlzcGxheV9tb2IgPSB0cnVlOy8vPz9cclxuXHJcblx0XHRcdC8vdGhpcy5tX2Rpc3BsYXlfc2tpbGw7XHJcblx0XHRcdC8vdGhpcy5tX2Rpc3BsYXlfbW9iX3NraWxsO1xyXG5cdFx0XHQvL3RoaXMubV9kaXNwbGF5X21vYl9lZmZlY3QgPSB0cnVlO1xyXG5cdFx0XHQvL3RoaXMubV9kaXNwbGF5X21vYl9ldGMgPSB0cnVlO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR7XHJcblx0XHRcdHRoaXMuTmFtZUxhYmVsX2RlZmF1bHRfc3R5bGUgPSBcIjIxNFwiO1xyXG5cclxuXHRcdFx0dGhpcy5DaGF0QmFsbG9vbl9kZWZhdWx0X3N0eWxlID0gXCIyMTJcIjtcclxuXHRcdFx0dGhpcy5DaGF0QmFsbG9vbl9kaXNwbGF5X2R1cmF0aW9uID0gNTAwMDtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0e1xyXG5cdFx0XHR0aGlzLmlucHV0X2tleURvd24gPSB7fTtcclxuXHRcdFx0dGhpcy5pbnB1dF9rZXlVcCA9IHt9O1xyXG5cclxuXHRcdFx0dGhpcy5tb3VzZV9tb3ZlID0gMDtcclxuXHRcdFx0dGhpcy5tb3VzZV94ID0gMDtcclxuXHRcdFx0dGhpcy5tb3VzZV95ID0gMDtcclxuXHRcdFx0dGhpcy5tb3VzZV9kbCA9IDA7XHJcblx0XHRcdHRoaXMubW91c2VfdWwgPSAwO1xyXG5cdFx0XHR0aGlzLm1vdXNlX2RtID0gMDtcclxuXHRcdFx0dGhpcy5tb3VzZV91bSA9IDA7XHJcblx0XHRcdHRoaXMubW91c2VfZHIgPSAwO1xyXG5cdFx0XHR0aGlzLm1vdXNlX3VyID0gMDtcclxuXHRcdH1cclxuXHJcblx0XHR7XHJcblx0XHRcdGxldCBTY2VuZU9iamVjdE1nciA9IHt9O1xyXG5cclxuXHRcdFx0U2NlbmVPYmplY3RNZ3IubGF5ZXJlZE9iamVjdHMgPSBbXTtcclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCAxMjsgKytpKSB7XHJcblx0XHRcdFx0bGV0IGxvID0gU2NlbmVPYmplY3RNZ3IubGF5ZXJlZE9iamVjdHNbaV0gPSB7fTtcclxuXHRcdFx0XHRPYmplY3QuZGVmaW5lUHJvcGVydHkobG8sIFwibGVuZ3RoXCIsIHtcclxuXHRcdFx0XHRcdGVudW1lcmFibGU6IGZhbHNlLFxyXG5cdFx0XHRcdFx0d3JpdGFibGU6IHRydWUsXHJcblx0XHRcdFx0XHR2YWx1ZTogMCxcclxuXHRcdFx0XHR9KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0U2NlbmVPYmplY3RNZ3IuVXBkYXRlID0gZnVuY3Rpb24gKHN0YW1wKSB7XHJcblx0XHRcdFx0Zm9yIChsZXQgbGF5ZXIgPSAwOyBsYXllciA8IFNjZW5lT2JqZWN0TWdyLmxheWVyZWRPYmplY3RzLmxlbmd0aDsgKytsYXllcikge1xyXG5cdFx0XHRcdFx0Y29uc3QgbG8gPSBTY2VuZU9iamVjdE1nci5sYXllcmVkT2JqZWN0c1tsYXllcl07XHJcblx0XHRcdFx0XHRmb3IgKGxldCB1aWQgaW4gbG8pIHtcclxuXHRcdFx0XHRcdFx0bGV0IG9iaiA9IGxvW3VpZF07XHJcblx0XHRcdFx0XHRcdG9iai51cGRhdGUoc3RhbXApO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRTY2VuZU9iamVjdE1nci5SZW5kZXJMYXllciA9IGZ1bmN0aW9uIChlbmdpbmUsIGxheWVyKSB7XHJcblx0XHRcdFx0Y29uc3QgbG8gPSBTY2VuZU9iamVjdE1nci5sYXllcmVkT2JqZWN0c1tsYXllcl07XHJcblx0XHRcdFx0Zm9yIChsZXQgdWlkIGluIGxvKSB7XHJcblx0XHRcdFx0XHRsZXQgb2JqID0gbG9bdWlkXTtcclxuXHRcdFx0XHRcdG9iai5yZW5kZXIoZW5naW5lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdFNjZW5lT2JqZWN0TWdyLmFkZFRvU2NlbmUgPSBmdW5jdGlvbiAobGF5ZXIsIG9iaikge1xyXG5cdFx0XHRcdGlmIChOdW1iZXIuaXNTYWZlSW50ZWdlcihsYXllcikgJiYgbGF5ZXIgaW4gU2NlbmVPYmplY3RNZ3IubGF5ZXJlZE9iamVjdHMpIHtcclxuXHRcdFx0XHRcdGNvbnN0IGxvID0gU2NlbmVPYmplY3RNZ3IubGF5ZXJlZE9iamVjdHNbbGF5ZXJdO1xyXG5cclxuXHRcdFx0XHRcdG9iai4kbGF5ZXIgPSBsYXllcjtcclxuXHRcdFx0XHRcdG9iai4kb2JqZWN0aWQgPSBsby5sZW5ndGg7XHJcblxyXG5cdFx0XHRcdFx0bG9bb2JqLiRvYmplY3RpZF0gPSBvYmo7XHJcblxyXG5cdFx0XHRcdFx0bG8ubGVuZ3RoKys7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdFx0dGhyb3cgbmV3IFR5cGVFcnJvcihcImxheWVyXCIpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cdFx0XHRTY2VuZU9iamVjdE1nci5kZXN0cm95ID0gZnVuY3Rpb24gKG9iaikge1xyXG5cdFx0XHRcdGNvbnN0IGxheWVyID0gb2JqLiRsYXllcjtcclxuXHRcdFx0XHRjb25zdCB1aWQgPSBvYmouJG9iamVjdGlkO1xyXG5cdFx0XHRcdGNvbnN0IGxvID0gU2NlbmVPYmplY3RNZ3IubGF5ZXJlZE9iamVjdHNbbGF5ZXJdO1xyXG5cclxuXHRcdFx0XHRvYmouZGVzdHJveSgpO1xyXG5cclxuXHRcdFx0XHRkZWxldGUgbG9bdWlkXTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0dGhpcy5TY2VuZU9iamVjdE1nciA9IFNjZW5lT2JqZWN0TWdyO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNvbnN0ICRndiA9IG5ldyBHbG9iYWxWYXIoKTtcclxuXHJcbndpbmRvdy4kZ3YgPSAkZ3Y7XHJcbiJdLCJtYXBwaW5ncyI6IkFBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsVUFNQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBRUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLFVBUUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxVQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTsiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///328\n')},478:function(module,exports){eval("/* (ignored) *///# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDc4LmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vL3dzIChpZ25vcmVkKT83N2EwIl0sInNvdXJjZXNDb250ZW50IjpbIi8qIChpZ25vcmVkKSAqLyJdLCJtYXBwaW5ncyI6IkFBQUEiLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///478\n")},483:function(module,__webpack_exports__,__webpack_require__){"use strict";eval('__webpack_require__.r(__webpack_exports__);\n\n// EXTERNAL MODULE: ./src/game/init.js\nvar init = __webpack_require__(328);\n\n// EXTERNAL MODULE: ./src/game/math.js\nvar math = __webpack_require__(333);\n\n// EXTERNAL MODULE: ./src/game/IRenderer.js\nvar IRenderer = __webpack_require__(332);\n\n// EXTERNAL MODULE: ./src/game/Engine.js + 1 modules\nvar Engine = __webpack_require__(335);\n\n// EXTERNAL MODULE: ./src/game/Animation.js\nvar Animation = __webpack_require__(334);\n\n// EXTERNAL MODULE: ./src/game/Map.js + 3 modules\nvar Map = __webpack_require__(355);\n\n// EXTERNAL MODULE: ./src/game/SceneCharacter.js + 3 modules\nvar SceneCharacter = __webpack_require__(352);\n\n// EXTERNAL MODULE: ./node_modules/socket.io-client/lib/index.js\nvar lib = __webpack_require__(469);\nvar lib_default = /*#__PURE__*/__webpack_require__.n(lib);\n\n// EXTERNAL MODULE: ./src/Client/PMovePath.js\nvar PMovePath = __webpack_require__(354);\n\n// EXTERNAL MODULE: ./src/Common/Packet/index.js\nvar Packet = __webpack_require__(377);\n\n// EXTERNAL MODULE: ./src/index.js\nvar src = __webpack_require__(91);\n\n// CONCATENATED MODULE: ./src/Client/Client.js\n\ufeff\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//debug\r\n//debug\r\n\r\n//debug\r\n\r\nclass $Socket {\r\n\t/**\r\n\t * socket.emit(eventName[, ...args])\r\n\t * return server answer\r\n\t * @param {string} eventName\r\n\t * @param {any} data\r\n\t * @returns {Promise<any>}\r\n\t */\r\n\temit(eventName, data) {\r\n\t}\r\n\ton(eventName, callback) {\r\n\t}\r\n\tonce(eventName, data) {\r\n\t}\r\n}\r\n\r\nclass Client_Client {\r\n\tconstructor() {\r\n\t\t/** @type {$Socket} */\r\n\t\tthis.socket = null;\r\n\r\n\t\t/** @type {{[id:string]:SceneCharacter}} */\r\n\t\tthis.charaMap = {};\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} charaId\r\n\t * @param {function(SceneCharacter)} cbfunc\r\n\t */\r\n\t_findChara(charaId, cbfunc) {\r\n\t\tif (false) {}\r\n\t\t/** @type {SceneCharacter} */\r\n\t\tlet chara = this.charaMap[charaId];\r\n\r\n\t\tif (chara) {\r\n\t\t\tcbfunc.call(this, chara);\r\n\t\t}\r\n\t\t//else {\r\n\t\t//\talert(`chara[\'${charaId}\'] not exist`);\r\n\t\t//}\r\n\t}\r\n\t/**\r\n\t * _addRemoteCharaPacketListener(eventName, fnAck(...))\r\n\t * @param {string} eventName\r\n\t * @param {function(...any, function(...any):void)} listener\r\n\t */\r\n\t_addRemoteCharaPacketListener(eventName, listener) {\r\n\t\tthis.socket.on(eventName, (...args) => {\r\n\t\t\t/** @type {string} */\r\n\t\t\tlet charaId = args[0].id;\r\n\r\n\t\t\t/** @type {SceneCharacter} */\r\n\t\t\tlet chara = this.charaMap[charaId];\r\n\r\n\t\t\tif (chara) {\r\n\t\t\t\tlistener.call(this, chara, ...args);//listener(chara, packet[, ...packet], fnAck)\r\n\t\t\t}\r\n\t\t\t//else {\r\n\t\t\t//\talert(`chara[\'${charaId}\'] not exist`);\r\n\t\t\t//}\r\n\t\t});\r\n\t}\r\n\t\r\n\t/**\r\n\t * @type {string} server_href\r\n\t * @returns {Promise<$Socket>}\r\n\t */\r\n\tasync connect(server_href) {\r\n\t\treturn await new Promise((resolve, reject) => {\r\n\t\t\tlet socket;\r\n\t\t\t\r\n\t\t\tsocket = lib_default()(server_href);\r\n\t\t\t\r\n\t\t\tsocket.on("connect", () => {\r\n\t\t\t\tthis.socket = socket;\r\n\t\t\t\t\r\n\t\t\t\twindow.$io = this.socket;\r\n\t\t\t\t\r\n\t\t\t\tconst emit = socket.$emit = socket.emit;\r\n\t\t\t\t\r\n\t\t\t\tsocket.emit = function (eventName, data) {\r\n\t\t\t\t\t//let cbfunc = arguments[arguments.length - 1];\r\n\t\t\t\t\t//if (typeof cbfunc == \'function\') {\r\n\t\t\t\t\t//\temit(eventName, data, cbfunc);\r\n\t\t\t\t\t//}\r\n\t\t\t\t\t//else {\r\n\t\t\t\t\t\treturn new Promise(function (resolve, reject) {\r\n\t\t\t\t\t\t\temit.call(socket, eventName, data, function (...args) {\r\n\t\t\t\t\t\t\t\tresolve.apply(this, args);\r\n\t\t\t\t\t\t\t});\r\n\t\t\t\t\t\t});\r\n\t\t\t\t\t//}\r\n\t\t\t\t};\r\n\t\t\t\t\r\n\t\t\t\tresolve(socket);\r\n\t\t\t});\r\n\t\t\tsocket.on("disconnect", () => {\r\n\t\t\t\twindow.location.reload();\r\n\t\t\t});\r\n\t\t\tsocket.on("connect_error", error => {\r\n\t\t\t\tsocket.disconnect();\r\n\t\t\t\treject(error);\r\n\t\t\t});\r\n\t\t});\r\n\t}\r\n\r\n\t/** @type {SceneMap} */\r\n\tget $scene_map() {\r\n\t\treturn window.scene_map;\r\n\t}\r\n\r\n\t/**\r\n\t * @param {string} account\r\n\t * @param {string} password\r\n\t */\r\n\tasync login(account, password) {\r\n\t\tlet result = await this.socket.emit("login", {\r\n\t\t\taccount: "aaa",\r\n\t\t\tpassword: "aaa",\r\n\t\t});\r\n\t\tif (result) {\r\n\t\t\tconsole.info("login");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.info("login failed");\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {number} world\r\n\t * @param {number} channel\r\n\t */\r\n\tasync selectWorld(world, channel) {\r\n\t\tlet result = await this.socket.emit("selectWorld", {\r\n\t\t\tworld: 0,\r\n\t\t\tchannel: 0,\r\n\t\t});\r\n\t\tif (result) {\r\n\t\t\tconsole.info("selectWorld");\r\n\t\t}\r\n\t\telse {\r\n\t\t\tconsole.info("selectWorld failed");\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * @param {any} charID\r\n\t */\r\n\tasync selectChara(charID) {\r\n\t\t/** @type {$RequestPacket_SelectChara} */\r\n\t\tlet req = new Packet["$RequestPacket_SelectChara"]();\r\n\t\t\r\n\t\t/** @type {$Packet_SelectChara} */\r\n\t\tlet ackPacket = await this.socket.emit("selectChara", {\r\n\t\t\tid: 123,\r\n\t\t});\r\n\t\tconst charaData = ackPacket.charaData;\r\n\t\tconst remoteCharacters = ackPacket.remoteCharacters;\r\n\r\n\t\tif (charaData) {\r\n\t\t\ttry {\r\n\t\t\t\tawait this.$scene_map.load(charaData.mapId);\r\n\t\t\t\t\r\n\t\t\t\tlet task1 = this._CreateMyCharacter(charaData);\r\n\t\t\t\tlet task2 = this.onEnterRemoteChara(remoteCharacters);\r\n\t\t\t\t\r\n\t\t\t\tawait Promise.all([task1, task2]);\r\n\t\t\t}\r\n\t\t\tcatch (ex) {\r\n\t\t\t\tconsole.error(ex);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\talert("selectChara: chara not exist");\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * online mode\r\n\t */\r\n\tasync _CreateMyCharacter(charaData) {\r\n\t\t/** @type {SceneCharacter} */\r\n\t\tlet chara = await src["app"].store.dispatch(\'_createChara\', {\r\n\t\t\templace: {\r\n\t\t\t\tid: charaData.id,\r\n\t\t\t\tcode: charaData.equips_code,\r\n\t\t\t}\r\n\t\t});\r\n\t\tthis.chara = chara;\r\n\r\n\t\tchara._$data = chara._$data || {\r\n\t\t\tguildId: "",//guildId == guildName\r\n\t\t\tpartyId: "",//partyId == partyName\r\n\t\t}\r\n\t}\r\n\t/**\r\n\t * offline mode\r\n\t * @param {{id:string,equips_code:string}} charaData\r\n\t */\r\n\tstatic async _CreateMyCharacter(charaData) {//??\r\n\t\t/** @type {SceneCharacter} */\r\n\t\tlet chara = await src["app"].store.dispatch(\'_createChara\', {\r\n\t\t\templace: {\r\n\t\t\t\tid: charaData.id,\r\n\t\t\t\tcode: charaData.equips_code,\r\n\t\t\t}\r\n\t\t});\r\n\t\tchara = chara;\r\n\r\n\t\tchara._$data = chara._$data || {\r\n\t\t\tguildId: "",//guildId == guildName\r\n\t\t\tpartyId: "",//partyId == partyName\r\n\t\t}\r\n\r\n\t\treturn chara;\r\n\t}\r\n\t/**\r\n\t * @param {$RemotePlayerData[]} packet - characters\r\n\t * @returns {Promise<void>}\r\n\t */\r\n\tonEnterRemoteChara(packet) {\r\n\t\tconst characters = packet;\r\n\r\n\t\tlet tasks = characters.map(charaData => {\r\n\t\t\treturn src["app"].store.dispatch(\'_createChara\', {\r\n\t\t\t\tremote_chara: {\r\n\t\t\t\t\tid: charaData.id,\r\n\t\t\t\t\tcode: charaData.equips_code,\r\n\t\t\t\t}\r\n\t\t\t}).then((...args) => {\r\n\t\t\t\ttry {\r\n\t\t\t\t\tconst world = this.$scene_map.controller;\r\n\r\n\t\t\t\t\t/** @type {SceneRemoteCharacter} */\r\n\t\t\t\t\tlet chara = args[0];\r\n\r\n\t\t\t\t\tthis.charaMap[chara.id] = chara;\r\n\t\t\t\t}\r\n\t\t\t\tcatch (ex) {\r\n\t\t\t\t\talert(err.message);\r\n\t\t\t\t\tconsole.error(err);\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t\t});\r\n\t\treturn Promise.all(tasks);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {{ id: string }} packet\r\n\t */\r\n\tonLeaveRemoteChara(packet) {\r\n\t\tconst remoteId = packet.id;\r\n\r\n\t\tsrc["app"].store.dispatch(\'deleteCharacter\', {\r\n\t\t\tid: remoteId,\r\n\t\t\tleave: true,\r\n\t\t}).then(() => {\r\n\t\t\tconsole.log("onLeaveRemoteChara[%o]", remoteId);\r\n\t\t}, (reason) => {\r\n\t\t\tconsole.log("onLeaveRemoteChara[%o]: %o", remoteId, reason);\r\n\t\t});\r\n\t\tdelete this.charaMap[packet.id];\r\n\t}\r\n\r\n\t/**\r\n\t * @param {MobMoveElem} packet\r\n\t */\r\n\tonMobMove(packet) {\r\n\t\t/** @type {SceneMap} */\r\n\t\tlet scene_map = window.scene_map;\r\n\r\n\t\tscene_map.lifeMgr.entities.forEach(life => {\r\n\t\t\tif (this.chara.$objectid == packet.controllerOwner) {\r\n\t\t\t\tif (life.spawn.type == "m" && life.$objectid == packet.objectid) {\r\n\t\t\t\t\t/** @type {MapMob} *///SceneMob\r\n\t\t\t\t\tconst mob = life;\r\n\t\t\t\t\tmob.$move(packet);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t}\r\n\t\t});\r\n\t}\r\n\r\n\t/**\r\n\t * @param {SceneCharacter} chara\r\n\t * @param {$Packet_RemoteChat} packet\r\n\t * @param {function(...any):void} fnAck\r\n\t */\r\n\tonRemoteChat(chara, packet, fnAck) {\r\n\t\tchara.chatCtrl.style = packet.style;\r\n\t\tchara.chatCtrl.enter(packet.text);\r\n\t\tapp.vue.$refs.statusBar.pushChatHistory(packet.type, packet.style, packet.text);\r\n\t}\r\n\t/**\r\n\t * @param {SceneCharacter} chara\r\n\t * @param {$Packet_CharacterMove} packet\r\n\t * @param {function(...any):void} fnAck\r\n\t */\r\n\tonRemoteCharaMove(chara, packet, fnAck) {\r\n\t\tchara.$move(packet);\r\n\t}\r\n\t/**\r\n\t * @param {SceneCharacter} chara\r\n\t * @param {$Packet_RemoteCharaAnim} packet\r\n\t * @param {function(...any):void} fnAck\r\n\t */\r\n\tonRemoteCharaAnim(chara, packet, fnAck) {\r\n\t\tchara.$anim(packet);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {SceneCharacter} chara\r\n\t * @param {} packet\r\n\t * @param {function(...any):void} fnAck\r\n\t */\r\n\tonRemoteCharaSkill(chara, packet, fnAck) {\r\n\t\tchara.invokeSkill(packet.skillId);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {SceneCharacter} chara\r\n\t * @param {} packet\r\n\t * @param {function(...any):void} fnAck\r\n\t */\r\n\tonRemoteAvatarModified(chara, packet, fnAck) {\r\n\t\tchara.renderer.use(packet.itemId);\r\n\t}\r\n\r\n\tasync $test() {\r\n\t\tthis.socket.on("enterRemoteChara", this.onEnterRemoteChara.bind(this));\r\n\t\tthis.socket.on("leaveRemoteChara", this.onLeaveRemoteChara.bind(this));\r\n\r\n\t\tthis.socket.on("mobMove", this.onMobMove.bind(this));\r\n\r\n\t\tthis._addRemoteCharaPacketListener("remoteChat", this.onRemoteChat);\r\n\t\tthis._addRemoteCharaPacketListener("remoteCharaMove", this.onRemoteCharaMove);\r\n\t\tthis._addRemoteCharaPacketListener("remoteCharaAnim", this.onRemoteCharaAnim);\r\n\t\tthis._addRemoteCharaPacketListener("remoteCharaSkill", this.onRemoteCharaSkill);\r\n\t\tthis._addRemoteCharaPacketListener("remoteAvatarModified", this.onRemoteAvatarModified);\r\n\r\n\t\tawait this.login("aaa", "aaa");\r\n\r\n\t\tawait this.selectWorld(0, 0);\r\n\r\n\t\tawait this.selectChara(0);\r\n\t}\r\n}\r\n\r\n\r\n\r\n\n// CONCATENATED MODULE: ./src/game/GameState.js\n\ufeff\r\n\r\n\r\n\r\n//debug\r\n\r\n//debug\r\n\r\n\r\nclass GameState {\r\n\tconstructor(scene, chara) {\r\n\t\t/** @type {string} */\r\n\t\tthis.map_id = scene.map_id;\r\n\r\n\t\tif (chara.renderer) {\r\n\t\t\t/** @type {string} */\r\n\t\t\tthis.chara = chara.renderer._stringify(false);\r\n\t\t\turl += "&chara=" + this.chara;\r\n\t\t}\r\n\t}\r\n}\r\n\r\nclass GameState_GameStateManager {\r\n\tconstructor() {\r\n\t\tthrow new Error("");\r\n\t}\r\n\r\n\t/**\r\n\t * @param {SceneMap} scene\r\n\t * @param {SceneCharacter} chara\r\n\t */\r\n\tstatic PushState(scene, chara) {\r\n\t\tif (!scene) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet state = {};\r\n\t\tlet url = "?map=" + scene.map_id;\r\n\r\n\t\tstate.map_id = scene.map_id;\r\n\r\n\t\tif (chara && chara.renderer) {\r\n\t\t\tstate.chara = chara.renderer._stringify(false);\r\n\t\t\turl += "&chara=" + state.chara;\r\n\t\t}\r\n\r\n\t\thistory.pushState(state, scene._window_title, url);\r\n\r\n\t\tdocument.title = scene._window_title;\r\n\t}\r\n\t/**\r\n\t * @param {string} map_id\r\n\t * @param {string} chara_code\r\n\t */\r\n\tstatic PushStateString(map_id, chara_code) {\r\n\t\tif (!map_id) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tlet state = {};\r\n\r\n\t\tlet url = "?map=" + map_id;\r\n\t\tstate.map_id = map_id;\r\n\r\n\t\tif (chara_code) {\r\n\t\t\tstate.chara = chara_code;\r\n\t\t\turl += "&chara=" + state.chara;\r\n\t\t}\r\n\r\n\t\thistory.pushState(state, scene._window_title, url);\r\n\r\n\t\tdocument.title = scene._window_title;\r\n\t}\r\n\tstatic async PopState(state) {\r\n\t\tif (!state) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t\r\n\t\tif (state.chara && window.chara && window.chara.renderer) {\r\n\t\t\tlet _old_c = window.chara.renderer._stringify(false);\r\n\t\t\tif (state.chara != _old_c) {\r\n\t\t\t\twindow.chara.renderer._parse(state.chara);\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tClient_Client._CreateMyCharacter({\r\n\t\t\t\tid: "chara_1",\r\n\t\t\t\tequips_code: state.chara,\r\n\t\t\t});\r\n\t\t\t//await gApp.store.dispatch(\'_createChara\', {\r\n\t\t\t//\templace: {\r\n\t\t\t//\t\tid: "chara_1",\r\n\t\t\t//\t\tcode: state.chara,\r\n\t\t\t//\t}\r\n\t\t\t//});\r\n\t\t}\r\n\r\n\t\tif (scene_map && scene_map.map_id != state.map_id) {\r\n\t\t\tawait scene_map.load(state.map_id);\r\n\t\t}\r\n\t}\r\n}\r\n\n// EXTERNAL MODULE: ./src/game/Skill.js\nvar Skill = __webpack_require__(359);\n\n// EXTERNAL MODULE: ./src/game/MobSkill/238.FairyDust.js\nvar _238_FairyDust = __webpack_require__(376);\n\n// EXTERNAL MODULE: ./src/game/Renderer/DamageNumber.js\nvar DamageNumber = __webpack_require__(378);\n\n// EXTERNAL MODULE: ./src/game/Renderer/SceneRenderer.js\nvar SceneRenderer = __webpack_require__(369);\n\n// CONCATENATED MODULE: ./src/game/Cursor.js\n\r\n\r\nclass CursorPicker {\r\n\tconstructor() {\r\n\t\t/** @type {string} */\r\n\t\tthis.type = null;\r\n\t\t/** @type {any} */\r\n\t\tthis.data = null;\r\n\t}\r\n}\r\n\r\n\r\nclass CursorAnimationFrame {\r\n\tconstructor() {\r\n\t\t/** @type {string} */\r\n\t\tthis.url = null;\r\n\t\t/** @type {number} */\r\n\t\tthis.x = 0;\r\n\t\t/** @type {number} */\r\n\t\tthis.y = 0;\r\n\t\t/** @type {number} - time in millisecond */\r\n\t\tthis.delay = 0;\r\n\t}\r\n}\r\n\r\nclass CursorAnimationData {\r\n\tconstructor() {\r\n\t\t/** @type {CursorAnimationFrame[]} */\r\n\t\tthis.frames = [];\r\n\r\n\t\t/** @type {number} - time in millisecond */\r\n\t\tthis.duration = 0;\r\n\t}\r\n\t/**\r\n\t * @param {string} url\r\n\t * @returns {Promise<number>} - index\r\n\t */\r\n\tasync addFrameFromUrl(url) {\r\n\t\tlet raw = await $get.data(url);\r\n\t\treturn this.addFrame("images" + url, raw.origin.x, raw.origin.y, raw.delay);\r\n\t}\r\n\t/**\r\n\t * @param {string} url\r\n\t * @param {number} x\r\n\t * @param {number} y\r\n\t * @param {number} delay\r\n\t * @returns {number} - index\r\n\t */\r\n\taddFrame(url, x, y, delay) {\r\n\t\tif (!url) {\r\n\t\t\tthrow new TypeError();\r\n\t\t}\r\n\t\tconst i = this.frames.length;\r\n\t\tlet frame = new CursorAnimationFrame();\r\n\r\n\t\tframe.url = url;\r\n\t\tframe.x = x | 0;\r\n\t\tframe.y = y | 0;\r\n\t\tframe.delay = delay | 0;\r\n\r\n\t\tthis.frames.push(frame);\r\n\r\n\t\tthis.duration += frame.delay; \r\n\r\n\t\treturn i;\r\n\t}\r\n\tasync load(url) {\r\n\t\tlet raw = await $get.data(url);\r\n\r\n\t\tfor (let i = 0, frame = raw[i]; frame; ++i, frame = raw[i]) {\r\n\t\t\tlet img = {};\r\n\r\n\t\t\tthis.addFrame(\r\n\t\t\t\t["images", url, i].join("/"),\r\n\t\t\t\tframe.origin.x,\r\n\t\t\t\tframe.origin.y,\r\n\t\t\t\tframe.delay\r\n\t\t\t);\r\n\t\t}\r\n\t}\r\n}\r\n\r\n\r\nclass Cursor  {\r\n\tconstructor(/*raw, url*/) {\r\n\t\t///** @type {Animation} */\r\n\t\t//this.ani = null;\r\n\t}\r\n\t//async createAnimation(url) {\r\n\t//\tlet raw = await $get.data(url);\r\n\t//\tthis.ani = new Animation(raw, url);\r\n\t//\tawait this.ani.load();\r\n\t//}\r\n\r\n\t/**\r\n\t * @param {CursorAnimationData} data\r\n\t * @param {string} selector\r\n\t * @param {string} keyword\r\n\t */\r\n\tstatic createToCSS(data, selector, keyword) {\r\n\t\tconst id = "Cursor" + Math.trunc(Math.random() * 0xFFFFFFFF).toString(16);\r\n\r\n\t\tconst { frames, duration } = data;\r\n\r\n\t\tlet cssText = `${selector}:hover {\\n`;\r\n\r\n\t\tcssText += `cursor: url(${frames[0].url}) ${frames[0].x} ${frames[0].y}, ${keyword};\\n`;\r\n\r\n\t\tif (duration) {\r\n\t\t\tcssText += `animation-name: ${id}_keyframes;\\n`;\r\n\t\t\tcssText += `animation-duration: ${duration}ms;\\n`;\r\n\t\t\tcssText += `animation-iteration-count: infinite;\\n`;\r\n\t\t\tcssText += "}\\n";\r\n\r\n\t\t\tlet tt = 0;\r\n\t\t\t{\r\n\t\t\t\tcssText += `@keyframes ${id}_keyframes {\\n`;\r\n\r\n\t\t\t\tfor (let i = 0; i < frames.length; ++i) {\r\n\t\t\t\t\tconst frame = frames[i];\r\n\r\n\t\t\t\t\tlet start = Math.trunc((tt / duration) * 100);\r\n\r\n\t\t\t\t\tcssText += `${start}% { cursor: url(${frames[i].url}) ${frames[i].x} ${frames[i].y}, ${keyword}; }\\n`;\r\n\r\n\t\t\t\t\ttt += frame.delay;\r\n\t\t\t\t}\r\n\t\t\t\t//cssText += `100% { cursor: url(${frames[0].url}) ${frames[0].x} ${frames[0].y}; }\\n`;\r\n\r\n\t\t\t\tcssText += "}\\n";\r\n\t\t\t}\r\n\t\t}\r\n\t\telse {\r\n\t\t\tcssText += "}";\r\n\t\t}\r\n\t\t\r\n\t\tvar x = document.createElement("STYLE");\r\n\t\tvar t = document.createTextNode(cssText);\r\n\t\tx.id = id;\r\n\t\tx.appendChild(t);\r\n\t\tdocument.head.appendChild(x);\r\n\r\n\t\treturn x;\r\n\t}\r\n}\r\n\n// EXTERNAL MODULE: ./src/ui/UIAnimationManager.js\nvar UIAnimationManager = __webpack_require__(420);\n\n// CONCATENATED MODULE: ./src/game/main.js\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, "Game", function() { return main_Game; });\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//import { SceneCharacter } from \'./SceneCharacter.js\';\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n\r\n//debug\r\n//debug\r\n\r\n\r\n\r\n\r\n\r\n\r\nSceneRenderer["a" /* sceneRenderer */].addLayerBack(12);\r\n\r\nwindow.SCREEN_PRINTLN = function (getText, getValue) {\r\n\tif (arguments.length == 2) {\r\n\t\twindow._SCREEN_PRINTLN.push({ getText, getValue });\r\n\t}\r\n\telse if (arguments.length == 1) {\r\n\t\twindow._SCREEN_PRINTLN.push(arguments[0]);\r\n\t}\r\n}\r\nwindow._SCREEN_PRINTLN = [];\r\n\r\nvar animationRequestID = null;\r\n\r\nwindow.addEventListener("popstate", function (e) {\r\n\tGameState_GameStateManager.PopState(e.state);\r\n});\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n//\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction createCursor_clickable() {\r\n\tlet data = new CursorAnimationData();\r\n\r\n\tlet task1 = data.addFrameFromUrl("/UI/Basic/Cursor/0/0").then(function (i) {\r\n\t\tdata.frames[i].delay = 200;\r\n\t});\r\n\r\n\tlet task2 = data.addFrameFromUrl("/UI/Basic/Cursor/12/0").then(function (i) {\r\n\t\tdata.frames[i].delay = 200;\r\n\t});\r\n\r\n\treturn Promise.all([task1, task2]).then(function () {\r\n\t\tdata.duration = 400;\r\n\r\n\t\tCursor.createToCSS(data, ".ui-clickable", "pointer");\r\n\t});\r\n}\r\n\r\ncreateCursor_clickable();\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n//\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n\r\n/**\r\n * @param {KeyboardEvent} e\r\n */\r\nwindow.onkeydown = function (e) {\r\n\tif (e.target != document.body) {\r\n\t\treturn;\r\n\t}\r\n\tlet k = e.key;\r\n\r\n\tif (k != null && !$gv.input_keyDown[k]) {\r\n\t\t$gv.input_keyDown[k] != null ? (++$gv.input_keyDown[k]) : ($gv.input_keyDown[k] = 1);\r\n\t}\r\n\r\n\tif (e.code == \'Space\') {\r\n\t\t$("#m_is_run").click();\r\n\t}\r\n\tif (e.code == "F2") {\r\n\t\t$gv.m_editor_mode = !$gv.m_editor_mode;\r\n\t}\r\n}\r\n\r\nwindow.onkeyup = function (e) {\r\n\tif (e.target != document.body) {\r\n\t\treturn;\r\n\t}\r\n\tlet k = e.key;\r\n\r\n\tif (k != null && $gv.input_keyDown[k]) {\r\n\t\t$gv.input_keyDown[k] = 0;\r\n\t\t$gv.input_keyUp[k] = 1;\r\n\t}\r\n}\r\n\r\nObject.defineProperty(window, "$m_is_run", {\r\n\tget: function () {\r\n\t\treturn $("#m_is_run").attr("checked");\r\n\t}, \r\n\tset: function (value) {\r\n\t\t$("#m_is_run").attr("checked", !value);\r\n\t\t$("#m_is_run").click();\r\n\t}\r\n});\r\n\r\n/**\r\n * @param {MouseEvent} e\r\n */\r\nwindow.onmousedown = function (e) {\r\n\tif ($gv.m_editor_mode) {\r\n\t\tif (!e.target.classList.contains("Editor")) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif (e.which == 1) {\r\n\t\t$gv.mouse_dl = 1;\r\n\t\t$gv.mouse_ul = 0;\r\n\t}\r\n\telse if (e.which == 2) {\r\n\t\t$gv.mouse_dm = 1;\r\n\t\t$gv.mouse_um = 0;\r\n\t}\r\n\telse if (e.which == 3) {\r\n\t\t$gv.mouse_dr = 1;\r\n\t\t$gv.mouse_ur = 0;\r\n\t}\r\n\t$gv.mouse_x = e.pageX;\r\n\t$gv.mouse_y = e.pageY;\r\n}\r\n\r\n/**\r\n * @param {MouseEvent} e\r\n */\r\nwindow.onmouseup = function (e) {\r\n\tif ($gv.m_editor_mode) {\r\n\t\tif (!e.target.classList.contains("Editor")) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\tif (e.which == 1) {\r\n\t\t$gv.mouse_dl = 0;\r\n\t\t$gv.mouse_ul = 1;\r\n\t}\r\n\telse if (e.which == 2) {\r\n\t\t$gv.mouse_dm = 0;\r\n\t\t$gv.mouse_um = 1;\r\n\t}\r\n\telse if (e.which == 3) {\r\n\t\t$gv.mouse_dr = 0;\r\n\t\t$gv.mouse_ur = 1;\r\n\t}\r\n\t$gv.mouse_x = e.pageX;\r\n\t$gv.mouse_y = e.pageY;\r\n}\r\n\r\n/**\r\n * @param {MouseEvent} e\r\n */\r\nwindow.onmousemove = function (e) {\r\n\tif ($gv.m_editor_mode) {\r\n\t\tif (!e.target.classList.contains("Editor")) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t}\r\n\t$gv.mouse_x = e.pageX;\r\n\t$gv.mouse_y = e.pageY;\r\n\t$gv.mouse_move = 1;\r\n}\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n//\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\n\r\nclass main_Game {\r\n\tconstructor() {\r\n\t\tthis.timer = 0;\r\n\t\tthis.timer_ = 0;\r\n\t\tthis._dTimer = 0;\r\n\t\tthis.fps_arr = [];\r\n\t\tthis.frame_s_arr = [];\r\n\t\t\r\n\t\t//this.chara = null;\r\n\t\t\r\n\t\t/** @type {SceneMap} */\r\n\t\tthis.scene_map = new Map["c" /* SceneMap */]();\r\n\r\n\t\twindow.scene_map = this.scene_map;\r\n\t\t$gv.scene_map = window;\r\n\r\n\t\tscene_map.onload = function () {\r\n\t\t\tGameState_GameStateManager.PushState(this, window.chara);\r\n\t\t}\r\n\t\t\r\n\t\tthis._loop = this._loop.bind(this);\r\n\t\t\r\n\t\tdocument.getElementById("m_is_run").onchange = (function (e) {\r\n\t\t\tthis.m_is_run = e.target.checked ? true : false;\r\n\t\t\tif (this.m_is_run) {\r\n\t\t\t\tanimationRequestID = requestAnimationFrame(this._loop);\r\n\t\t\t\tdocument.getElementById("Screenshot").innerHTML = "";\r\n\t\t\t}\r\n\t\t}).bind(this);\r\n\r\n\t\tthis._$moveViewportSpeed = 10;//debug\r\n\t}\r\n\t\r\n\tmoveViewport(inBound) {\r\n\t\tconst scene_map = this.scene_map;\r\n\r\n\t\tconst speed = $gv.input_keyDown[\'z\'] ? (this._$moveViewportSpeed * 10) : this._$moveViewportSpeed;\r\n\r\n\t\t//$gv.m_viewRect = scene_map.viewArea(new Vec2($gv.m_viewRect.left, $gv.m_viewRect.top));\r\n\r\n\t\tif ($gv.input_keyDown[\'ArrowLeft\'] > 0) {\r\n\t\t\t$gv.m_viewRect.left -= speed;\r\n\t\t}\r\n\t\tif ($gv.input_keyDown[\'ArrowRight\'] > 0) {\r\n\t\t\t$gv.m_viewRect.left += speed;\r\n\t\t}\r\n\t\tif ($gv.input_keyDown[\'ArrowUp\'] > 0) {\r\n\t\t\t$gv.m_viewRect.top -= speed;\r\n\t\t}\r\n\t\tif ($gv.input_keyDown[\'ArrowDown\'] > 0) {\r\n\t\t\t$gv.m_viewRect.top += speed;\r\n\t\t}\r\n\r\n\t\tlet { left, top, right, bottom } = scene_map.mapBound;\r\n\r\n\t\tif (inBound) {\r\n\t\t\tif ($gv.m_viewRect.left < left) {\r\n\t\t\t\t$gv.m_viewRect.left = left;\r\n\t\t\t}\r\n\t\t\tif ($gv.m_viewRect.right > right) {\r\n\t\t\t\t$gv.m_viewRect.left = right - $gv.m_viewRect.width;\r\n\t\t\t}\r\n\t\t\tif ($gv.m_viewRect.top < top) {\r\n\t\t\t\t$gv.m_viewRect.top = top;\r\n\t\t\t}\r\n\t\t\tif ($gv.m_viewRect.bottom > bottom) {\r\n\t\t\t\t$gv.m_viewRect.top = bottom - $gv.m_viewRect.height;\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {string} server\r\n\t */\r\n\tasync _$startClient(server) {\r\n\t\tif (scene_map) {\r\n\t\t\tlet client = new Client_Client();\r\n\t\t\t\r\n\t\t\ttry {\r\n\t\t\t\tawait client.connect(server);\r\n\t\t\t\tconsole.log("start client");\r\n\t\t\t}\r\n\t\t\tcatch (err) {\r\n\t\t\t\tconsole.error(err);\r\n\t\t\t\tconsole.log("start offline");\r\n\t\t\t\tthis._$start_offline();\r\n\t\t\t\treturn;\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tsrc["app"].client = client;\r\n\t\t\tclient.$test();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tdebugger;\r\n\t\t}\r\n\t}\r\n\t_$start_offline() {\r\n\t\tlet params = _parseUrlParameter();\r\n\t\tlet map_id;\r\n\t\r\n\t\tif (true) {\r\n\t\t\tmap_id = params["map"] || window.DEFAULT_MAP_ID;\r\n\t\t}\r\n\t\telse {}\r\n\t\r\n\t\tlet chara_code = params["chara"] || "c,00002012,00012012,00026509|00026509,00034873|00034873,01051429,01072392";\r\n\t\r\n\t\tGameState_GameStateManager.PopState({\r\n\t\t\tmap_id: map_id,\r\n\t\t\tchara: chara_code,\r\n\t\t});\r\n\t}\r\n\r\n\t/** @type {boolean} */\r\n\tget _isMapReady() {\r\n\t\tconst scene_map = this.scene_map;\r\n\t\treturn scene_map && scene_map.isLoaded();\r\n\t}\r\n\t\r\n\tasync run() {\r\n\t\tconsole.log("begin render");\r\n\t\tthis._loop(0);//start render\r\n\t}\r\n\t\r\n\tasync forceUpdateScreen() {\r\n\t\tconst chara = this.chara;\r\n\t\t\r\n\t\tthis._updateScene(0);\r\n\t\t\r\n\t\tchara.renderer.__forceUpdate(0);\r\n\t\t\r\n\t\tif (this.m_is_run) {\r\n\t\t\tawait chara.renderer.waitLoaded();\r\n\t\t\tchara.renderer.__require_update = true;//update once\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tawait chara.renderer.waitLoaded();\r\n\t\tawait chara.renderer._waitFrameTexturesLoaded();\r\n\t\tawait IRenderer["IGraph"].waitAllLoaded();\r\n\t\t\r\n\t\tdocument.getElementById("Screenshot").innerHTML = "";\r\n\t\t\r\n\t\tchara.renderer.__require_update = true;//update once\r\n\t\t\r\n\t\tthis._loop(0);\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} stamp\r\n\t */\r\n\t_calcFPS(stamp) {\r\n\t\ttry {\r\n\t\t\tif ((this.timer - this.timer_) >= 1000) {\r\n\t\t\t\tif (this.fps_arr.length) {\r\n\t\t\t\t\tlet sum = this.fps_arr.reduce(function (a, b) { return a + b; });\r\n\t\t\t\t\tlet avg = sum / this.fps_arr.length;\r\n\t\t\t\t\t\r\n\t\t\t\t\t$gv.FPS = avg;\r\n\t\t\t\t\t\r\n\t\t\t\t\tdocument.getElementById("FPS").innerHTML = avg.toFixed(2);\r\n\t\t\t\t}\r\n\t\t\t\tif (this.frame_s_arr.length) {\r\n\t\t\t\t\tlet sum = this.frame_s_arr.reduce(function (a, b) { return a + b; });\r\n\t\t\t\t\tlet avg = sum / this.frame_s_arr.length;\r\n\t\t\t\t\t\r\n\t\t\t\t\t$gv.frameCount = avg;\r\n\t\t\t\t\t\r\n\t\t\t\t\tdocument.getElementById("frame").innerHTML = avg.toFixed(2);\r\n\t\t\t\t}\r\n\r\n\t\t\t\tthis.frame_s_arr = [];\r\n\t\t\t\tthis.fps_arr = [];\r\n\r\n\t\t\t\tthis.timer_ = this.timer;\r\n\t\t\t}\r\n\t\t\telse if (stamp > 0 && Number.isFinite(stamp)) {\r\n\t\t\t\tthis.fps_arr.push(1000 / stamp);\r\n\t\t\t\tthis.frame_s_arr.push(stamp);\r\n\t\t\t}\r\n\t\t}\r\n\t\tcatch (ex) {\r\n\t\t\tdebugger;\r\n\t\t\tdocument.getElementById("FPS").innerHTML = "-";\r\n\t\t\tdocument.getElementById("frame").innerHTML = "-";\r\n\t\t\tthis.fps_arr = [];\r\n\t\t\tthis.frame_s_arr = [];\r\n\t\t}\r\n\t}\r\n\r\n\t_requestNextFrame() {\r\n\t\tif (this.m_is_run) {\r\n\t\t\tanimationRequestID = requestAnimationFrame(this._loop);\r\n\t\t}\r\n\t\telse {\r\n\t\t\t//async\r\n\t\t\tsetTimeout(function () {\r\n\t\t\t\tlet elem = new Image();\r\n\t\t\t\telem.src = Engine["engine"]._canvas.toDataURL();\r\n\t\t\t\tEngine["engine"].ctx.clearRect(0, 0, Engine["engine"].ctx.width, Engine["engine"].ctx.height);\r\n\t\t\t\tdocument.getElementById("Screenshot").appendChild(elem);\r\n\t\t\t}, 0);\r\n\t\t}\r\n\t}\r\n\r\n\t/**\r\n\t * @param {number} stamp\r\n\t */\r\n\t_updateScene(stamp) {\r\n\t\t/** @type {SceneCharacter} */\r\n\t\tconst chara = this.chara;\r\n\r\n\t\t/** @type {SceneCharacter[]} */\r\n\t\tconst charaList = this.charaList;\r\n\r\n\t\t{\r\n\t\t\tif (this._isMapReady) {\r\n\t\t\t\tscene_map.update(stamp);//include world.update\r\n\t\t\t}\r\n\r\n\t\t\t// before world.update ??\r\n\t\t\tfor (let i = 0; i < charaList.length; ++i) {\r\n\t\t\t\tcharaList[i].update(stamp);\r\n\t\t\t}\r\n\r\n\t\t\t$gv.SceneObjectMgr.Update(stamp);\r\n\r\n\t\t\tSkill["a" /* EffectManager */].Update(stamp);\r\n\t\t}\r\n\t\t{\r\n\t\t\tconst client = src["app"].client;//not offline character\r\n\r\n\t\t\tif (client && client.chara) {\r\n\t\t\t\t/** @type {SceneCharacter} */\r\n\t\t\t\tconst ch = client.chara;\r\n\t\t\t\t\r\n\t\t\t\tch.$emit(window.$io);\r\n\r\n\t\t\t\tch.$recMove();\r\n\t\t\t}\r\n\t\t}\r\n\t\t\r\n\t\tSceneRenderer["a" /* sceneRenderer */].update(stamp);\r\n\t\t\r\n\t\tDamageNumber["a" /* damageNumberLayer */].update(stamp);\r\n\t}\r\n\t\r\n\t_renderScene() {\r\n\t\tif (this._isMapReady) {\r\n\t\t\tthis._render_map_ready();\r\n\t\t}\r\n\t\telse {\r\n\t\t\tthis._render_map_loading();\r\n\t\t}\r\n\t}\r\n\t_render_map_ready() {\r\n\t\t/** @type {SceneCharacter} */\r\n\t\tconst chara = this.chara;\r\n\r\n\t\t/** @type {SceneCharacter[]} */\r\n\t\tconst charaList = this.charaList;\r\n\t\t\r\n\t\tEngine["engine"].beginScene();\r\n\t\t{\r\n\t\t\tEngine["engine"].loadIdentity();\r\n\t\t\tEngine["engine"].clearDrawScreen();\r\n\t\t\t\r\n\t\t\t$gv.m_viewRect.size = Engine["engine"].screen_size;\r\n\t\t\tif (!$gv.m_editor_mode) {\r\n\t\t\t\tif (chara && chara.renderer) {\r\n\t\t\t\t\t$gv.m_viewRect.setCenter(chara.renderer.x, chara.renderer.y);\r\n\t\t\t\t}\r\n\t\t\t\telse if (scene_map.controller.player) {\r\n\t\t\t\t\tconst pos = scene_map.controller.player.getPosition();\r\n\t\t\t\t\tconst px = Math.trunc(pos.x * $gv.CANVAS_SCALE + 0.5);\r\n\t\t\t\t\tconst py = Math.trunc(pos.y * $gv.CANVAS_SCALE + 0.5);\r\n\t\t\t\t\t$gv.m_viewRect.setCenter(px, py);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tif ($gv.m_editor_mode) {\r\n\t\t\t\tthis.moveViewport(false);\r\n\t\t\t}\r\n\t\t\tif ($gv.m_is_rendering_map) {\r\n\t\t\t\tscene_map.beginRender(Engine["engine"]);\r\n\t\t\t\t{\r\n\t\t\t\t\tscene_map.renderBackground(Engine["engine"]);\r\n\t\t\t\t\t//if ($gv.m_display_life && scene_map._raw.info.mirror_Bottom) {\r\n\t\t\t\t\t//\tengine.ctx.setTransform(1, 0, 0, 1, 0, 0);\r\n\t\t\t\t\t//\tengine.ctx.translate(Math.trunc(-$gv.m_viewRect.x), Math.trunc(-$gv.m_viewRect.y));\r\n\t\t\t\t\t//\tengine.ctx.scale(1, -1);\r\n\t\t\t\t\t//\tfor (let i = 0; i < scene_map.layeredObject.length; ++i) {\r\n\t\t\t\t\t//\t\tscene_map.renderLife(engine, i);\r\n\t\t\t\t\t//\t}\r\n\t\t\t\t\t//}\r\n\t\t\t\t\tfor (let i = 0; i < scene_map.layeredObject.length; ++i) {\r\n\t\t\t\t\t\tscene_map.renderLayeredObject(Engine["engine"], i);\r\n\t\t\t\t\t\tscene_map.renderLayeredTile(Engine["engine"], i);\r\n\t\t\t\t\t\t\r\n\t\t\t\t\t\tscene_map.applyCamera(Engine["engine"]);\r\n\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\tif ($gv.m_display_other_player) {\r\n\t\t\t\t\t\t\t\tfor (let chara_index = 0; chara_index < charaList.length; ++chara_index) {\r\n\t\t\t\t\t\t\t\t\tif (charaList[chara_index] == chara) {\r\n\t\t\t\t\t\t\t\t\t\tcontinue;\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\telse if (charaList[chara_index].$layer == i) {\r\n\t\t\t\t\t\t\t\t\t\tcharaList[chara_index].render(Engine["engine"]);\r\n\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tscene_map.renderLife(Engine["engine"], i);\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\tif ($gv.m_display_player && chara) {\r\n\t\t\t\t\t\t\t\tif ((chara.$layer == null || chara.$layer == i) && chara.renderer) {\r\n\t\t\t\t\t\t\t\t\tchara.render(Engine["engine"]);\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t$gv.SceneObjectMgr.RenderLayer(Engine["engine"], i);\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tSceneRenderer["a" /* sceneRenderer */].renderLayer(Engine["engine"], i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tscene_map.applyCamera(Engine["engine"]);\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tfor (let i = scene_map.layeredObject.length; i < 12; ++i) {\r\n\t\t\t\t\t\t\t$gv.SceneObjectMgr.RenderLayer(Engine["engine"], i);\r\n\t\t\t\t\t\t\t//\r\n\t\t\t\t\t\t\tSceneRenderer["a" /* sceneRenderer */].renderLayer(Engine["engine"], i);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tscene_map.endRender(Engine["engine"]);\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\t//TODO: layer\r\n\t\t\t\t\r\n\t\t\t\tfor (let i = 0; i < SceneRenderer["a" /* sceneRenderer */].layers.length; ++i) {\r\n\t\t\t\t\tSceneRenderer["a" /* sceneRenderer */].renderLayer(Engine["engine"], i);\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t\tif ($gv.m_display_other_player || $gv.m_display_player) {\r\n\t\t\t\t\tscene_map.applyCamera(Engine["engine"]);\r\n\t\t\t\t\t\r\n\t\t\t\t\tfor (let i = 0; i < charaList.length; ++i) {\r\n\t\t\t\t\t\tif (charaList[i] != chara && $gv.m_display_other_player) {\r\n\t\t\t\t\t\t\tcharaList[i].render(Engine["engine"]);\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif ($gv.m_display_player && chara) {\r\n\t\t\t\t\t\tchara.render(Engine["engine"]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tSkill["a" /* EffectManager */].Render(Engine["engine"]);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\tDamageNumber["a" /* damageNumberLayer */].render(Engine["engine"]);\r\n\r\n\t\t\tfor (let i = 0; i < charaList.length; ++i) {\r\n\t\t\t\tcharaList[i]._$drawName(Engine["engine"]);\r\n\t\t\t}\r\n\t\t\tfor (let i = 0; i < charaList.length; ++i) {\r\n\t\t\t\tcharaList[i]._$drawChatBalloon(Engine["engine"]);\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\tif ($gv.m_is_rendering_map) {\r\n\t\t\t\tscene_map.beginRender(Engine["engine"]);\r\n\t\t\t\t{\r\n\t\t\t\t\tscene_map.applyCamera(Engine["engine"]);\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tscene_map.renderPortal(Engine["engine"]);\r\n\t\t\t\t\t}\r\n\t\t\t\t\t\r\n\t\t\t\t\tscene_map.renderFrontground(Engine["engine"]);\r\n\t\t\t\t}\r\n\t\t\t\tscene_map.endRender(Engine["engine"]);\r\n\t\t\t\t\r\n\t\t\t\tscene_map.renderParticle(Engine["engine"]);\r\n\r\n\t\t\t\tscene_map.applyCamera(Engine["engine"]);\r\n\t\t\t\t{\r\n\t\t\t\t\tSkill["a" /* EffectManager */].Render(Engine["engine"]);\r\n\t\t\t\t}\r\n\t\t\t\tEngine["engine"].loadIdentity();\r\n\t\t\t}\r\n\t\t\t\r\n\t\t\t{\r\n\t\t\t\tscene_map.applyCamera(Engine["engine"]);\r\n\t\t\t\t\r\n\t\t\t\tif ($gv.m_display_debug_info) {\r\n\t\t\t\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\t\t\t\tconst ctx = Engine["engine"].ctx;\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\tctx.beginPath();\r\n\r\n\t\t\t\t\t\tctx.fillStyle = "white";\r\n\t\t\t\t\t\tctx.fillRect(0, 0, 96, 50);\r\n\r\n\t\t\t\t\t\tctx.fillStyle = "black";\r\n\t\t\t\t\t\tctx.fillText("map origin", 5, 14, 96);\r\n\r\n\t\t\t\t\t\tctx.fillText("view-x: " + $gv.m_viewRect.x.toFixed(0), 5, 30, 96);\r\n\r\n\t\t\t\t\t\tctx.fillText("view-y: " + $gv.m_viewRect.y.toFixed(0), 5, 46, 96);\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tscene_map.controller.render(Engine["engine"]);\r\n\t\t\t\t\r\n\t\t\t\tEngine["engine"].loadIdentity();\r\n\t\t\t\t\r\n\t\t\t\tif ($gv.m_display_debug_info) {\r\n\t\t\t\t\tthis._render_debug_info();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t\tEngine["engine"].endScene();\r\n\t}\r\n\t_render_map_loading() {\r\n\t\tconst ctx = Engine["engine"].ctx;\r\n\t\tconst screen_width = Engine["engine"].screen_size.x;\r\n\t\tconst screen_height = Engine["engine"].screen_size.y;\r\n\t\tconst scr_hw = screen_width * 0.5;\r\n\t\tconst scr_hh = screen_height * 0.5;\r\n\t\t\r\n\t\tctx.font = "2em 微軟正黑體";\r\n\t\tctx.textAlign = "center";\r\n\t\tctx.textBaseline = "center";\r\n\t\t\r\n\t\tctx.fillStyle = "white";\r\n\t\tctx.fillText("loading...", scr_hw, scr_hh);\r\n\t\t\r\n\t\tctx.strokeStyle = "black";\r\n\t\tctx.fillText("loading...", scr_hw, scr_hh);\r\n\t}\r\n\r\n\t_render_debug_info() {\r\n\t\tif (!(scene_map.controller && scene_map.controller.player)) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t/** @type {CanvasRenderingContext2D} */\r\n\t\tconst ctx = Engine["engine"].ctx;\r\n\r\n\t\tconst ta = ctx.textAlign, tb = ctx.textBaseline, lw = ctx.lineWidth;\r\n\t\tctx.textBaseline = "top";\r\n\t\tctx.lineWidth = 2.5;\r\n\t\tctx.strokeStyle = "#000";\r\n\t\tlet x = 400, y = 5;\r\n\t\tfor (let line of window._SCREEN_PRINTLN) {\r\n\t\t\tconst val = line.getValue();\r\n\t\t\tconst text = line.getText();\r\n\r\n\t\t\tctx.fillStyle = "#FFF";\r\n\t\t\t{\r\n\t\t\t\tctx.textAlign = "right";\r\n\t\t\t\tctx.strokeText(text, x - 2, y);\r\n\t\t\t\tctx.fillText(text, x - 2, y);\r\n\r\n\t\t\t\tctx.textAlign = "center";\r\n\t\t\t\tctx.strokeText(":", x, y);\r\n\t\t\t\tctx.fillText(":", x, y);\r\n\r\n\t\t\t\tctx.textAlign = "left";\r\n\t\t\t\tctx.strokeText(val, x + 2, y);\r\n\t\t\t\tctx.fillText(val, x + 2, y);\r\n\t\t\t}\r\n\r\n\t\t\tif ("_val" in line) {\r\n\t\t\t\tlet _val;\r\n\t\t\t\tif (line._val != val) {\r\n\t\t\t\t\t_val = line._val;//display new value\r\n\t\t\t\t\tline.__val = line._val;\r\n\t\t\t\t\tline._val = val;\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\t_val = line.__val;//display old value\r\n\t\t\t\t}\r\n\t\t\t\tif (_val != val) {\r\n\t\t\t\t\tctx.fillStyle = "#0FF";\r\n\t\t\t\t}\r\n\r\n\t\t\t\tctx.fillStyle = "#FFF";\r\n\t\t\t\t{\r\n\t\t\t\t\tctx.textAlign = "right";\r\n\t\t\t\t\tctx.strokeText(text, x - 2 + 200, y);\r\n\t\t\t\t\tctx.fillText(text, x - 2 + 200, y);\r\n\r\n\t\t\t\t\tctx.textAlign = "center";\r\n\t\t\t\t\tctx.strokeText(":", x + 200, y);\r\n\t\t\t\t\tctx.fillText(":", x + 200, y);\r\n\r\n\t\t\t\t\tctx.textAlign = "left";\r\n\t\t\t\t\tctx.strokeText(_val, x + 2 + 200, y);\r\n\t\t\t\t\tctx.fillText(_val, x + 2 + 200, y);\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t\telse {\r\n\t\t\t\tline.__val = val;\r\n\t\t\t\tline._val = val;\r\n\t\t\t}\r\n\r\n\t\t\ty += 16;\r\n\t\t}\r\n\t\tctx.textAlign = ta;\r\n\t\tctx.textBaseline = tb;\r\n\t\tctx.lineWidth = lw;\r\n\t}\r\n\t\r\n\t/**\r\n\t * @param {DOMHighResTimeStamp} timeStamp\r\n\t */\r\n\t_loop(timeStamp) {\r\n\t\tconst scene_map = this.scene_map;\r\n\t\tconst stamp = timeStamp - this.timer;\r\n\t\t\r\n\t\tthis.timer = timeStamp;\r\n\r\n\t\tthis._requestNextFrame();\r\n\r\n\t\tthis._calcFPS(stamp);\r\n\t\r\n\t\tthis._updateScene(stamp);\r\n\r\n\t\tthis._renderScene();\r\n\t\t\r\n\t\tfor (let i in $gv.input_keyDown) {\r\n\t\t\tif ($gv.input_keyDown[i] > 0) {\r\n\t\t\t\t++$gv.input_keyDown[i];\r\n\t\t\t}\r\n\t\t}\r\n\t\tfor (let i in $gv.input_keyUp) {\r\n\t\t\t$gv.input_keyUp[i] = 0;\r\n\t\t}\r\n\t\t\r\n\t\tUIAnimationManager["b" /* uiAnimationManager */].update(stamp);\r\n\t}\r\n\t\r\n\tget chara() {\r\n\t\treturn window.chara;\r\n\t}\r\n\t//set chara(value) {\r\n\t//\twindow.chara = value;\r\n\t//}\r\n\r\n\tget charaList() {\r\n\t\treturn src["app"].store.state.charaList;\r\n\t}\r\n\t\r\n\tget m_is_run() {\r\n\t\treturn window.m_is_run;\r\n\t}\r\n\tset m_is_run(value) {\r\n\t\twindow.m_is_run = value;\r\n\t}\r\n}\r\n\r\n\r\n///////////////////////////////////////////////////////////////////////////////\r\n//\r\n///////////////////////////////////////////////////////////////////////////////\r\n\r\nfunction _parseUrlParameter() {\r\n\tlet sPageURL = decodeURIComponent(window.location.search.substring(1));\r\n\tlet sURLVariables = sPageURL.split("&");\r\n\tlet params = {};\r\n\r\n\tfor (let i = 0; i < sURLVariables.length; ++i) {\r\n\t\tlet sParameter = sURLVariables[i].split("=");\r\n\r\n\t\tparams[sParameter[0]] = sParameter[1];\r\n\t}\r\n\r\n\treturn params;\r\n};\r\n\r\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiNDgzLmpzIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vLy4vc3JjL0NsaWVudC9DbGllbnQuanM/YzRmNSIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZS9HYW1lU3RhdGUuanM/ODI1MCIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZS9DdXJzb3IuanM/ZjI2MiIsIndlYnBhY2s6Ly8vLi9zcmMvZ2FtZS9tYWluLmpzPzk2ZWYiXSwic291cmNlc0NvbnRlbnQiOlsi77u/XHJcbmltcG9ydCBpbyBmcm9tIFwic29ja2V0LmlvLWNsaWVudFwiO1xyXG5cclxuaW1wb3J0IHsgR2FtZVN0YXRlTWFuYWdlciB9IGZyb20gXCIuLi9nYW1lL0dhbWVTdGF0ZS5qc1wiO1xyXG5cclxuaW1wb3J0IHsgU2NlbmVNYXAgfSBmcm9tIFwiLi4vZ2FtZS9NYXAuanNcIjtcclxuaW1wb3J0IHsgU2NlbmVDaGFyYWN0ZXIsIFNjZW5lUmVtb3RlQ2hhcmFjdGVyIH0gZnJvbSBcIi4uL2dhbWUvU2NlbmVDaGFyYWN0ZXIuanNcIjtcclxuXHJcbmltcG9ydCB7IENoYXJhY3Rlck1vdmVFbGVtLCBNb2JNb3ZlRWxlbSB9IGZyb20gXCIuLi9DbGllbnQvUE1vdmVQYXRoLmpzXCI7Ly9kZWJ1Z1xyXG5pbXBvcnQgeyAkUmVxdWVzdFBhY2tldF9TZWxlY3RDaGFyYSwgJFJlc3BvbnNlUGFja2V0X1NlbGVjdENoYXJhLFxyXG5cdFx0ICRQYWNrZXRfUmVtb3RlQ2hhdCxcclxuXHRcdCAkUGFja2V0X0NoYXJhY3Rlck1vdmUsXHJcblx0XHR9IGZyb20gXCIuLi9Db21tb24vUGFja2V0XCI7Ly9kZWJ1Z1xyXG5cclxuaW1wb3J0IHsgYXBwIGFzIGdBcHAgfSBmcm9tIFwiLi4vaW5kZXguanNcIjsvL2RlYnVnXHJcblxyXG5jbGFzcyAkU29ja2V0IHtcclxuXHQvKipcclxuXHQgKiBzb2NrZXQuZW1pdChldmVudE5hbWVbLCAuLi5hcmdzXSlcclxuXHQgKiByZXR1cm4gc2VydmVyIGFuc3dlclxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBldmVudE5hbWVcclxuXHQgKiBAcGFyYW0ge2FueX0gZGF0YVxyXG5cdCAqIEByZXR1cm5zIHtQcm9taXNlPGFueT59XHJcblx0ICovXHJcblx0ZW1pdChldmVudE5hbWUsIGRhdGEpIHtcclxuXHR9XHJcblx0b24oZXZlbnROYW1lLCBjYWxsYmFjaykge1xyXG5cdH1cclxuXHRvbmNlKGV2ZW50TmFtZSwgZGF0YSkge1xyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIENsaWVudCB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvKiogQHR5cGUgeyRTb2NrZXR9ICovXHJcblx0XHR0aGlzLnNvY2tldCA9IG51bGw7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHt7W2lkOnN0cmluZ106U2NlbmVDaGFyYWN0ZXJ9fSAqL1xyXG5cdFx0dGhpcy5jaGFyYU1hcCA9IHt9O1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGNoYXJhSWRcclxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9uKFNjZW5lQ2hhcmFjdGVyKX0gY2JmdW5jXHJcblx0ICovXHJcblx0X2ZpbmRDaGFyYShjaGFyYUlkLCBjYmZ1bmMpIHtcclxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gJ3Byb2R1Y3Rpb24nKSB7XHJcblx0XHRcdGlmICh0eXBlb2YgY2JmdW5jICE9ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHRjb25zb2xlLmVycm9yKG5ldyBUeXBlRXJyb3IoKSk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdC8qKiBAdHlwZSB7U2NlbmVDaGFyYWN0ZXJ9ICovXHJcblx0XHRsZXQgY2hhcmEgPSB0aGlzLmNoYXJhTWFwW2NoYXJhSWRdO1xyXG5cclxuXHRcdGlmIChjaGFyYSkge1xyXG5cdFx0XHRjYmZ1bmMuY2FsbCh0aGlzLCBjaGFyYSk7XHJcblx0XHR9XHJcblx0XHQvL2Vsc2Uge1xyXG5cdFx0Ly9cdGFsZXJ0KGBjaGFyYVsnJHtjaGFyYUlkfSddIG5vdCBleGlzdGApO1xyXG5cdFx0Ly99XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIF9hZGRSZW1vdGVDaGFyYVBhY2tldExpc3RlbmVyKGV2ZW50TmFtZSwgZm5BY2soLi4uKSlcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gZXZlbnROYW1lXHJcblx0ICogQHBhcmFtIHtmdW5jdGlvbiguLi5hbnksIGZ1bmN0aW9uKC4uLmFueSk6dm9pZCl9IGxpc3RlbmVyXHJcblx0ICovXHJcblx0X2FkZFJlbW90ZUNoYXJhUGFja2V0TGlzdGVuZXIoZXZlbnROYW1lLCBsaXN0ZW5lcikge1xyXG5cdFx0dGhpcy5zb2NrZXQub24oZXZlbnROYW1lLCAoLi4uYXJncykgPT4ge1xyXG5cdFx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdFx0bGV0IGNoYXJhSWQgPSBhcmdzWzBdLmlkO1xyXG5cclxuXHRcdFx0LyoqIEB0eXBlIHtTY2VuZUNoYXJhY3Rlcn0gKi9cclxuXHRcdFx0bGV0IGNoYXJhID0gdGhpcy5jaGFyYU1hcFtjaGFyYUlkXTtcclxuXHJcblx0XHRcdGlmIChjaGFyYSkge1xyXG5cdFx0XHRcdGxpc3RlbmVyLmNhbGwodGhpcywgY2hhcmEsIC4uLmFyZ3MpOy8vbGlzdGVuZXIoY2hhcmEsIHBhY2tldFssIC4uLnBhY2tldF0sIGZuQWNrKVxyXG5cdFx0XHR9XHJcblx0XHRcdC8vZWxzZSB7XHJcblx0XHRcdC8vXHRhbGVydChgY2hhcmFbJyR7Y2hhcmFJZH0nXSBub3QgZXhpc3RgKTtcclxuXHRcdFx0Ly99XHJcblx0XHR9KTtcclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogQHR5cGUge3N0cmluZ30gc2VydmVyX2hyZWZcclxuXHQgKiBAcmV0dXJucyB7UHJvbWlzZTwkU29ja2V0Pn1cclxuXHQgKi9cclxuXHRhc3luYyBjb25uZWN0KHNlcnZlcl9ocmVmKSB7XHJcblx0XHRyZXR1cm4gYXdhaXQgbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xyXG5cdFx0XHRsZXQgc29ja2V0O1xyXG5cdFx0XHRcclxuXHRcdFx0c29ja2V0ID0gaW8oc2VydmVyX2hyZWYpO1xyXG5cdFx0XHRcclxuXHRcdFx0c29ja2V0Lm9uKFwiY29ubmVjdFwiLCAoKSA9PiB7XHJcblx0XHRcdFx0dGhpcy5zb2NrZXQgPSBzb2NrZXQ7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0d2luZG93LiRpbyA9IHRoaXMuc29ja2V0O1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNvbnN0IGVtaXQgPSBzb2NrZXQuJGVtaXQgPSBzb2NrZXQuZW1pdDtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRzb2NrZXQuZW1pdCA9IGZ1bmN0aW9uIChldmVudE5hbWUsIGRhdGEpIHtcclxuXHRcdFx0XHRcdC8vbGV0IGNiZnVuYyA9IGFyZ3VtZW50c1thcmd1bWVudHMubGVuZ3RoIC0gMV07XHJcblx0XHRcdFx0XHQvL2lmICh0eXBlb2YgY2JmdW5jID09ICdmdW5jdGlvbicpIHtcclxuXHRcdFx0XHRcdC8vXHRlbWl0KGV2ZW50TmFtZSwgZGF0YSwgY2JmdW5jKTtcclxuXHRcdFx0XHRcdC8vfVxyXG5cdFx0XHRcdFx0Ly9lbHNlIHtcclxuXHRcdFx0XHRcdFx0cmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHtcclxuXHRcdFx0XHRcdFx0XHRlbWl0LmNhbGwoc29ja2V0LCBldmVudE5hbWUsIGRhdGEsIGZ1bmN0aW9uICguLi5hcmdzKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRyZXNvbHZlLmFwcGx5KHRoaXMsIGFyZ3MpO1xyXG5cdFx0XHRcdFx0XHRcdH0pO1xyXG5cdFx0XHRcdFx0XHR9KTtcclxuXHRcdFx0XHRcdC8vfVxyXG5cdFx0XHRcdH07XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0cmVzb2x2ZShzb2NrZXQpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0c29ja2V0Lm9uKFwiZGlzY29ubmVjdFwiLCAoKSA9PiB7XHJcblx0XHRcdFx0d2luZG93LmxvY2F0aW9uLnJlbG9hZCgpO1xyXG5cdFx0XHR9KTtcclxuXHRcdFx0c29ja2V0Lm9uKFwiY29ubmVjdF9lcnJvclwiLCBlcnJvciA9PiB7XHJcblx0XHRcdFx0c29ja2V0LmRpc2Nvbm5lY3QoKTtcclxuXHRcdFx0XHRyZWplY3QoZXJyb3IpO1xyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqIEB0eXBlIHtTY2VuZU1hcH0gKi9cclxuXHRnZXQgJHNjZW5lX21hcCgpIHtcclxuXHRcdHJldHVybiB3aW5kb3cuc2NlbmVfbWFwO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IGFjY291bnRcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gcGFzc3dvcmRcclxuXHQgKi9cclxuXHRhc3luYyBsb2dpbihhY2NvdW50LCBwYXNzd29yZCkge1xyXG5cdFx0bGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc29ja2V0LmVtaXQoXCJsb2dpblwiLCB7XHJcblx0XHRcdGFjY291bnQ6IFwiYWFhXCIsXHJcblx0XHRcdHBhc3N3b3JkOiBcImFhYVwiLFxyXG5cdFx0fSk7XHJcblx0XHRpZiAocmVzdWx0KSB7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcImxvZ2luXCIpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcImxvZ2luIGZhaWxlZFwiKTtcclxuXHRcdH1cclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHdvcmxkXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IGNoYW5uZWxcclxuXHQgKi9cclxuXHRhc3luYyBzZWxlY3RXb3JsZCh3b3JsZCwgY2hhbm5lbCkge1xyXG5cdFx0bGV0IHJlc3VsdCA9IGF3YWl0IHRoaXMuc29ja2V0LmVtaXQoXCJzZWxlY3RXb3JsZFwiLCB7XHJcblx0XHRcdHdvcmxkOiAwLFxyXG5cdFx0XHRjaGFubmVsOiAwLFxyXG5cdFx0fSk7XHJcblx0XHRpZiAocmVzdWx0KSB7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcInNlbGVjdFdvcmxkXCIpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdGNvbnNvbGUuaW5mbyhcInNlbGVjdFdvcmxkIGZhaWxlZFwiKTtcclxuXHRcdH1cclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHthbnl9IGNoYXJJRFxyXG5cdCAqL1xyXG5cdGFzeW5jIHNlbGVjdENoYXJhKGNoYXJJRCkge1xyXG5cdFx0LyoqIEB0eXBlIHskUmVxdWVzdFBhY2tldF9TZWxlY3RDaGFyYX0gKi9cclxuXHRcdGxldCByZXEgPSBuZXcgJFJlcXVlc3RQYWNrZXRfU2VsZWN0Q2hhcmEoKTtcclxuXHRcdFxyXG5cdFx0LyoqIEB0eXBlIHskUGFja2V0X1NlbGVjdENoYXJhfSAqL1xyXG5cdFx0bGV0IGFja1BhY2tldCA9IGF3YWl0IHRoaXMuc29ja2V0LmVtaXQoXCJzZWxlY3RDaGFyYVwiLCB7XHJcblx0XHRcdGlkOiAxMjMsXHJcblx0XHR9KTtcclxuXHRcdGNvbnN0IGNoYXJhRGF0YSA9IGFja1BhY2tldC5jaGFyYURhdGE7XHJcblx0XHRjb25zdCByZW1vdGVDaGFyYWN0ZXJzID0gYWNrUGFja2V0LnJlbW90ZUNoYXJhY3RlcnM7XHJcblxyXG5cdFx0aWYgKGNoYXJhRGF0YSkge1xyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGF3YWl0IHRoaXMuJHNjZW5lX21hcC5sb2FkKGNoYXJhRGF0YS5tYXBJZCk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0bGV0IHRhc2sxID0gdGhpcy5fQ3JlYXRlTXlDaGFyYWN0ZXIoY2hhcmFEYXRhKTtcclxuXHRcdFx0XHRsZXQgdGFzazIgPSB0aGlzLm9uRW50ZXJSZW1vdGVDaGFyYShyZW1vdGVDaGFyYWN0ZXJzKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRhd2FpdCBQcm9taXNlLmFsbChbdGFzazEsIHRhc2syXSk7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0Y29uc29sZS5lcnJvcihleCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRhbGVydChcInNlbGVjdENoYXJhOiBjaGFyYSBub3QgZXhpc3RcIik7XHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIG9ubGluZSBtb2RlXHJcblx0ICovXHJcblx0YXN5bmMgX0NyZWF0ZU15Q2hhcmFjdGVyKGNoYXJhRGF0YSkge1xyXG5cdFx0LyoqIEB0eXBlIHtTY2VuZUNoYXJhY3Rlcn0gKi9cclxuXHRcdGxldCBjaGFyYSA9IGF3YWl0IGdBcHAuc3RvcmUuZGlzcGF0Y2goJ19jcmVhdGVDaGFyYScsIHtcclxuXHRcdFx0ZW1wbGFjZToge1xyXG5cdFx0XHRcdGlkOiBjaGFyYURhdGEuaWQsXHJcblx0XHRcdFx0Y29kZTogY2hhcmFEYXRhLmVxdWlwc19jb2RlLFxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuY2hhcmEgPSBjaGFyYTtcclxuXHJcblx0XHRjaGFyYS5fJGRhdGEgPSBjaGFyYS5fJGRhdGEgfHwge1xyXG5cdFx0XHRndWlsZElkOiBcIlwiLC8vZ3VpbGRJZCA9PSBndWlsZE5hbWVcclxuXHRcdFx0cGFydHlJZDogXCJcIiwvL3BhcnR5SWQgPT0gcGFydHlOYW1lXHJcblx0XHR9XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIG9mZmxpbmUgbW9kZVxyXG5cdCAqIEBwYXJhbSB7e2lkOnN0cmluZyxlcXVpcHNfY29kZTpzdHJpbmd9fSBjaGFyYURhdGFcclxuXHQgKi9cclxuXHRzdGF0aWMgYXN5bmMgX0NyZWF0ZU15Q2hhcmFjdGVyKGNoYXJhRGF0YSkgey8vPz9cclxuXHRcdC8qKiBAdHlwZSB7U2NlbmVDaGFyYWN0ZXJ9ICovXHJcblx0XHRsZXQgY2hhcmEgPSBhd2FpdCBnQXBwLnN0b3JlLmRpc3BhdGNoKCdfY3JlYXRlQ2hhcmEnLCB7XHJcblx0XHRcdGVtcGxhY2U6IHtcclxuXHRcdFx0XHRpZDogY2hhcmFEYXRhLmlkLFxyXG5cdFx0XHRcdGNvZGU6IGNoYXJhRGF0YS5lcXVpcHNfY29kZSxcclxuXHRcdFx0fVxyXG5cdFx0fSk7XHJcblx0XHRjaGFyYSA9IGNoYXJhO1xyXG5cclxuXHRcdGNoYXJhLl8kZGF0YSA9IGNoYXJhLl8kZGF0YSB8fCB7XHJcblx0XHRcdGd1aWxkSWQ6IFwiXCIsLy9ndWlsZElkID09IGd1aWxkTmFtZVxyXG5cdFx0XHRwYXJ0eUlkOiBcIlwiLC8vcGFydHlJZCA9PSBwYXJ0eU5hbWVcclxuXHRcdH1cclxuXHJcblx0XHRyZXR1cm4gY2hhcmE7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7JFJlbW90ZVBsYXllckRhdGFbXX0gcGFja2V0IC0gY2hhcmFjdGVyc1xyXG5cdCAqIEByZXR1cm5zIHtQcm9taXNlPHZvaWQ+fVxyXG5cdCAqL1xyXG5cdG9uRW50ZXJSZW1vdGVDaGFyYShwYWNrZXQpIHtcclxuXHRcdGNvbnN0IGNoYXJhY3RlcnMgPSBwYWNrZXQ7XHJcblxyXG5cdFx0bGV0IHRhc2tzID0gY2hhcmFjdGVycy5tYXAoY2hhcmFEYXRhID0+IHtcclxuXHRcdFx0cmV0dXJuIGdBcHAuc3RvcmUuZGlzcGF0Y2goJ19jcmVhdGVDaGFyYScsIHtcclxuXHRcdFx0XHRyZW1vdGVfY2hhcmE6IHtcclxuXHRcdFx0XHRcdGlkOiBjaGFyYURhdGEuaWQsXHJcblx0XHRcdFx0XHRjb2RlOiBjaGFyYURhdGEuZXF1aXBzX2NvZGUsXHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KS50aGVuKCguLi5hcmdzKSA9PiB7XHJcblx0XHRcdFx0dHJ5IHtcclxuXHRcdFx0XHRcdGNvbnN0IHdvcmxkID0gdGhpcy4kc2NlbmVfbWFwLmNvbnRyb2xsZXI7XHJcblxyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtTY2VuZVJlbW90ZUNoYXJhY3Rlcn0gKi9cclxuXHRcdFx0XHRcdGxldCBjaGFyYSA9IGFyZ3NbMF07XHJcblxyXG5cdFx0XHRcdFx0dGhpcy5jaGFyYU1hcFtjaGFyYS5pZF0gPSBjaGFyYTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0Y2F0Y2ggKGV4KSB7XHJcblx0XHRcdFx0XHRhbGVydChlcnIubWVzc2FnZSk7XHJcblx0XHRcdFx0XHRjb25zb2xlLmVycm9yKGVycik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9KTtcclxuXHRcdH0pO1xyXG5cdFx0cmV0dXJuIFByb21pc2UuYWxsKHRhc2tzKTtcclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7eyBpZDogc3RyaW5nIH19IHBhY2tldFxyXG5cdCAqL1xyXG5cdG9uTGVhdmVSZW1vdGVDaGFyYShwYWNrZXQpIHtcclxuXHRcdGNvbnN0IHJlbW90ZUlkID0gcGFja2V0LmlkO1xyXG5cclxuXHRcdGdBcHAuc3RvcmUuZGlzcGF0Y2goJ2RlbGV0ZUNoYXJhY3RlcicsIHtcclxuXHRcdFx0aWQ6IHJlbW90ZUlkLFxyXG5cdFx0XHRsZWF2ZTogdHJ1ZSxcclxuXHRcdH0pLnRoZW4oKCkgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIm9uTGVhdmVSZW1vdGVDaGFyYVslb11cIiwgcmVtb3RlSWQpO1xyXG5cdFx0fSwgKHJlYXNvbikgPT4ge1xyXG5cdFx0XHRjb25zb2xlLmxvZyhcIm9uTGVhdmVSZW1vdGVDaGFyYVslb106ICVvXCIsIHJlbW90ZUlkLCByZWFzb24pO1xyXG5cdFx0fSk7XHJcblx0XHRkZWxldGUgdGhpcy5jaGFyYU1hcFtwYWNrZXQuaWRdO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtNb2JNb3ZlRWxlbX0gcGFja2V0XHJcblx0ICovXHJcblx0b25Nb2JNb3ZlKHBhY2tldCkge1xyXG5cdFx0LyoqIEB0eXBlIHtTY2VuZU1hcH0gKi9cclxuXHRcdGxldCBzY2VuZV9tYXAgPSB3aW5kb3cuc2NlbmVfbWFwO1xyXG5cclxuXHRcdHNjZW5lX21hcC5saWZlTWdyLmVudGl0aWVzLmZvckVhY2gobGlmZSA9PiB7XHJcblx0XHRcdGlmICh0aGlzLmNoYXJhLiRvYmplY3RpZCA9PSBwYWNrZXQuY29udHJvbGxlck93bmVyKSB7XHJcblx0XHRcdFx0aWYgKGxpZmUuc3Bhd24udHlwZSA9PSBcIm1cIiAmJiBsaWZlLiRvYmplY3RpZCA9PSBwYWNrZXQub2JqZWN0aWQpIHtcclxuXHRcdFx0XHRcdC8qKiBAdHlwZSB7TWFwTW9ifSAqLy8vU2NlbmVNb2JcclxuXHRcdFx0XHRcdGNvbnN0IG1vYiA9IGxpZmU7XHJcblx0XHRcdFx0XHRtb2IuJG1vdmUocGFja2V0KTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSB7XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtTY2VuZUNoYXJhY3Rlcn0gY2hhcmFcclxuXHQgKiBAcGFyYW0geyRQYWNrZXRfUmVtb3RlQ2hhdH0gcGFja2V0XHJcblx0ICogQHBhcmFtIHtmdW5jdGlvbiguLi5hbnkpOnZvaWR9IGZuQWNrXHJcblx0ICovXHJcblx0b25SZW1vdGVDaGF0KGNoYXJhLCBwYWNrZXQsIGZuQWNrKSB7XHJcblx0XHRjaGFyYS5jaGF0Q3RybC5zdHlsZSA9IHBhY2tldC5zdHlsZTtcclxuXHRcdGNoYXJhLmNoYXRDdHJsLmVudGVyKHBhY2tldC50ZXh0KTtcclxuXHRcdGFwcC52dWUuJHJlZnMuc3RhdHVzQmFyLnB1c2hDaGF0SGlzdG9yeShwYWNrZXQudHlwZSwgcGFja2V0LnN0eWxlLCBwYWNrZXQudGV4dCk7XHJcblx0fVxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7U2NlbmVDaGFyYWN0ZXJ9IGNoYXJhXHJcblx0ICogQHBhcmFtIHskUGFja2V0X0NoYXJhY3Rlck1vdmV9IHBhY2tldFxyXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uYW55KTp2b2lkfSBmbkFja1xyXG5cdCAqL1xyXG5cdG9uUmVtb3RlQ2hhcmFNb3ZlKGNoYXJhLCBwYWNrZXQsIGZuQWNrKSB7XHJcblx0XHRjaGFyYS4kbW92ZShwYWNrZXQpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge1NjZW5lQ2hhcmFjdGVyfSBjaGFyYVxyXG5cdCAqIEBwYXJhbSB7JFBhY2tldF9SZW1vdGVDaGFyYUFuaW19IHBhY2tldFxyXG5cdCAqIEBwYXJhbSB7ZnVuY3Rpb24oLi4uYW55KTp2b2lkfSBmbkFja1xyXG5cdCAqL1xyXG5cdG9uUmVtb3RlQ2hhcmFBbmltKGNoYXJhLCBwYWNrZXQsIGZuQWNrKSB7XHJcblx0XHRjaGFyYS4kYW5pbShwYWNrZXQpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtTY2VuZUNoYXJhY3Rlcn0gY2hhcmFcclxuXHQgKiBAcGFyYW0ge30gcGFja2V0XHJcblx0ICogQHBhcmFtIHtmdW5jdGlvbiguLi5hbnkpOnZvaWR9IGZuQWNrXHJcblx0ICovXHJcblx0b25SZW1vdGVDaGFyYVNraWxsKGNoYXJhLCBwYWNrZXQsIGZuQWNrKSB7XHJcblx0XHRjaGFyYS5pbnZva2VTa2lsbChwYWNrZXQuc2tpbGxJZCk7XHJcblx0fVxyXG5cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge1NjZW5lQ2hhcmFjdGVyfSBjaGFyYVxyXG5cdCAqIEBwYXJhbSB7fSBwYWNrZXRcclxuXHQgKiBAcGFyYW0ge2Z1bmN0aW9uKC4uLmFueSk6dm9pZH0gZm5BY2tcclxuXHQgKi9cclxuXHRvblJlbW90ZUF2YXRhck1vZGlmaWVkKGNoYXJhLCBwYWNrZXQsIGZuQWNrKSB7XHJcblx0XHRjaGFyYS5yZW5kZXJlci51c2UocGFja2V0Lml0ZW1JZCk7XHJcblx0fVxyXG5cclxuXHRhc3luYyAkdGVzdCgpIHtcclxuXHRcdHRoaXMuc29ja2V0Lm9uKFwiZW50ZXJSZW1vdGVDaGFyYVwiLCB0aGlzLm9uRW50ZXJSZW1vdGVDaGFyYS5iaW5kKHRoaXMpKTtcclxuXHRcdHRoaXMuc29ja2V0Lm9uKFwibGVhdmVSZW1vdGVDaGFyYVwiLCB0aGlzLm9uTGVhdmVSZW1vdGVDaGFyYS5iaW5kKHRoaXMpKTtcclxuXHJcblx0XHR0aGlzLnNvY2tldC5vbihcIm1vYk1vdmVcIiwgdGhpcy5vbk1vYk1vdmUuYmluZCh0aGlzKSk7XHJcblxyXG5cdFx0dGhpcy5fYWRkUmVtb3RlQ2hhcmFQYWNrZXRMaXN0ZW5lcihcInJlbW90ZUNoYXRcIiwgdGhpcy5vblJlbW90ZUNoYXQpO1xyXG5cdFx0dGhpcy5fYWRkUmVtb3RlQ2hhcmFQYWNrZXRMaXN0ZW5lcihcInJlbW90ZUNoYXJhTW92ZVwiLCB0aGlzLm9uUmVtb3RlQ2hhcmFNb3ZlKTtcclxuXHRcdHRoaXMuX2FkZFJlbW90ZUNoYXJhUGFja2V0TGlzdGVuZXIoXCJyZW1vdGVDaGFyYUFuaW1cIiwgdGhpcy5vblJlbW90ZUNoYXJhQW5pbSk7XHJcblx0XHR0aGlzLl9hZGRSZW1vdGVDaGFyYVBhY2tldExpc3RlbmVyKFwicmVtb3RlQ2hhcmFTa2lsbFwiLCB0aGlzLm9uUmVtb3RlQ2hhcmFTa2lsbCk7XHJcblx0XHR0aGlzLl9hZGRSZW1vdGVDaGFyYVBhY2tldExpc3RlbmVyKFwicmVtb3RlQXZhdGFyTW9kaWZpZWRcIiwgdGhpcy5vblJlbW90ZUF2YXRhck1vZGlmaWVkKTtcclxuXHJcblx0XHRhd2FpdCB0aGlzLmxvZ2luKFwiYWFhXCIsIFwiYWFhXCIpO1xyXG5cclxuXHRcdGF3YWl0IHRoaXMuc2VsZWN0V29ybGQoMCwgMCk7XHJcblxyXG5cdFx0YXdhaXQgdGhpcy5zZWxlY3RDaGFyYSgwKTtcclxuXHR9XHJcbn1cclxuXHJcblxyXG5cclxuIiwi77u/XHJcbmltcG9ydCB7IFNjZW5lTWFwIH0gZnJvbSBcIi4vTWFwLmpzXCI7XHJcbmltcG9ydCB7IFNjZW5lQ2hhcmFjdGVyIH0gZnJvbSBcIi4vU2NlbmVDaGFyYWN0ZXIuanNcIjtcclxuXHJcbmltcG9ydCB7IENsaWVudCB9IGZyb20gXCIuLi9DbGllbnQvQ2xpZW50LmpzXCI7Ly9kZWJ1Z1xyXG5cclxuaW1wb3J0IHsgYXBwIGFzIGdBcHAgfSBmcm9tIFwiLi4vaW5kZXguanNcIjsvL2RlYnVnXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVTdGF0ZSB7XHJcblx0Y29uc3RydWN0b3Ioc2NlbmUsIGNoYXJhKSB7XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMubWFwX2lkID0gc2NlbmUubWFwX2lkO1xyXG5cclxuXHRcdGlmIChjaGFyYS5yZW5kZXJlcikge1xyXG5cdFx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdFx0dGhpcy5jaGFyYSA9IGNoYXJhLnJlbmRlcmVyLl9zdHJpbmdpZnkoZmFsc2UpO1xyXG5cdFx0XHR1cmwgKz0gXCImY2hhcmE9XCIgKyB0aGlzLmNoYXJhO1xyXG5cdFx0fVxyXG5cdH1cclxufVxyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWVTdGF0ZU1hbmFnZXIge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0dGhyb3cgbmV3IEVycm9yKFwiXCIpO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtTY2VuZU1hcH0gc2NlbmVcclxuXHQgKiBAcGFyYW0ge1NjZW5lQ2hhcmFjdGVyfSBjaGFyYVxyXG5cdCAqL1xyXG5cdHN0YXRpYyBQdXNoU3RhdGUoc2NlbmUsIGNoYXJhKSB7XHJcblx0XHRpZiAoIXNjZW5lKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBzdGF0ZSA9IHt9O1xyXG5cdFx0bGV0IHVybCA9IFwiP21hcD1cIiArIHNjZW5lLm1hcF9pZDtcclxuXHJcblx0XHRzdGF0ZS5tYXBfaWQgPSBzY2VuZS5tYXBfaWQ7XHJcblxyXG5cdFx0aWYgKGNoYXJhICYmIGNoYXJhLnJlbmRlcmVyKSB7XHJcblx0XHRcdHN0YXRlLmNoYXJhID0gY2hhcmEucmVuZGVyZXIuX3N0cmluZ2lmeShmYWxzZSk7XHJcblx0XHRcdHVybCArPSBcIiZjaGFyYT1cIiArIHN0YXRlLmNoYXJhO1xyXG5cdFx0fVxyXG5cclxuXHRcdGhpc3RvcnkucHVzaFN0YXRlKHN0YXRlLCBzY2VuZS5fd2luZG93X3RpdGxlLCB1cmwpO1xyXG5cclxuXHRcdGRvY3VtZW50LnRpdGxlID0gc2NlbmUuX3dpbmRvd190aXRsZTtcclxuXHR9XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IG1hcF9pZFxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBjaGFyYV9jb2RlXHJcblx0ICovXHJcblx0c3RhdGljIFB1c2hTdGF0ZVN0cmluZyhtYXBfaWQsIGNoYXJhX2NvZGUpIHtcclxuXHRcdGlmICghbWFwX2lkKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdGxldCBzdGF0ZSA9IHt9O1xyXG5cclxuXHRcdGxldCB1cmwgPSBcIj9tYXA9XCIgKyBtYXBfaWQ7XHJcblx0XHRzdGF0ZS5tYXBfaWQgPSBtYXBfaWQ7XHJcblxyXG5cdFx0aWYgKGNoYXJhX2NvZGUpIHtcclxuXHRcdFx0c3RhdGUuY2hhcmEgPSBjaGFyYV9jb2RlO1xyXG5cdFx0XHR1cmwgKz0gXCImY2hhcmE9XCIgKyBzdGF0ZS5jaGFyYTtcclxuXHRcdH1cclxuXHJcblx0XHRoaXN0b3J5LnB1c2hTdGF0ZShzdGF0ZSwgc2NlbmUuX3dpbmRvd190aXRsZSwgdXJsKTtcclxuXHJcblx0XHRkb2N1bWVudC50aXRsZSA9IHNjZW5lLl93aW5kb3dfdGl0bGU7XHJcblx0fVxyXG5cdHN0YXRpYyBhc3luYyBQb3BTdGF0ZShzdGF0ZSkge1xyXG5cdFx0aWYgKCFzdGF0ZSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdGlmIChzdGF0ZS5jaGFyYSAmJiB3aW5kb3cuY2hhcmEgJiYgd2luZG93LmNoYXJhLnJlbmRlcmVyKSB7XHJcblx0XHRcdGxldCBfb2xkX2MgPSB3aW5kb3cuY2hhcmEucmVuZGVyZXIuX3N0cmluZ2lmeShmYWxzZSk7XHJcblx0XHRcdGlmIChzdGF0ZS5jaGFyYSAhPSBfb2xkX2MpIHtcclxuXHRcdFx0XHR3aW5kb3cuY2hhcmEucmVuZGVyZXIuX3BhcnNlKHN0YXRlLmNoYXJhKTtcclxuXHRcdFx0fVxyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdENsaWVudC5fQ3JlYXRlTXlDaGFyYWN0ZXIoe1xyXG5cdFx0XHRcdGlkOiBcImNoYXJhXzFcIixcclxuXHRcdFx0XHRlcXVpcHNfY29kZTogc3RhdGUuY2hhcmEsXHJcblx0XHRcdH0pO1xyXG5cdFx0XHQvL2F3YWl0IGdBcHAuc3RvcmUuZGlzcGF0Y2goJ19jcmVhdGVDaGFyYScsIHtcclxuXHRcdFx0Ly9cdGVtcGxhY2U6IHtcclxuXHRcdFx0Ly9cdFx0aWQ6IFwiY2hhcmFfMVwiLFxyXG5cdFx0XHQvL1x0XHRjb2RlOiBzdGF0ZS5jaGFyYSxcclxuXHRcdFx0Ly9cdH1cclxuXHRcdFx0Ly99KTtcclxuXHRcdH1cclxuXHJcblx0XHRpZiAoc2NlbmVfbWFwICYmIHNjZW5lX21hcC5tYXBfaWQgIT0gc3RhdGUubWFwX2lkKSB7XHJcblx0XHRcdGF3YWl0IHNjZW5lX21hcC5sb2FkKHN0YXRlLm1hcF9pZCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcbiIsIlxyXG5cclxuZXhwb3J0IGNsYXNzIEN1cnNvclBpY2tlciB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvKiogQHR5cGUge3N0cmluZ30gKi9cclxuXHRcdHRoaXMudHlwZSA9IG51bGw7XHJcblx0XHQvKiogQHR5cGUge2FueX0gKi9cclxuXHRcdHRoaXMuZGF0YSA9IG51bGw7XHJcblx0fVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEN1cnNvckFuaW1hdGlvbkZyYW1lIHtcclxuXHRjb25zdHJ1Y3RvcigpIHtcclxuXHRcdC8qKiBAdHlwZSB7c3RyaW5nfSAqL1xyXG5cdFx0dGhpcy51cmwgPSBudWxsO1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLnggPSAwO1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9ICovXHJcblx0XHR0aGlzLnkgPSAwO1xyXG5cdFx0LyoqIEB0eXBlIHtudW1iZXJ9IC0gdGltZSBpbiBtaWxsaXNlY29uZCAqL1xyXG5cdFx0dGhpcy5kZWxheSA9IDA7XHJcblx0fVxyXG59XHJcblxyXG5leHBvcnQgY2xhc3MgQ3Vyc29yQW5pbWF0aW9uRGF0YSB7XHJcblx0Y29uc3RydWN0b3IoKSB7XHJcblx0XHQvKiogQHR5cGUge0N1cnNvckFuaW1hdGlvbkZyYW1lW119ICovXHJcblx0XHR0aGlzLmZyYW1lcyA9IFtdO1xyXG5cclxuXHRcdC8qKiBAdHlwZSB7bnVtYmVyfSAtIHRpbWUgaW4gbWlsbGlzZWNvbmQgKi9cclxuXHRcdHRoaXMuZHVyYXRpb24gPSAwO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHJldHVybnMge1Byb21pc2U8bnVtYmVyPn0gLSBpbmRleFxyXG5cdCAqL1xyXG5cdGFzeW5jIGFkZEZyYW1lRnJvbVVybCh1cmwpIHtcclxuXHRcdGxldCByYXcgPSBhd2FpdCAkZ2V0LmRhdGEodXJsKTtcclxuXHRcdHJldHVybiB0aGlzLmFkZEZyYW1lKFwiaW1hZ2VzXCIgKyB1cmwsIHJhdy5vcmlnaW4ueCwgcmF3Lm9yaWdpbi55LCByYXcuZGVsYXkpO1xyXG5cdH1cclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge3N0cmluZ30gdXJsXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHhcclxuXHQgKiBAcGFyYW0ge251bWJlcn0geVxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBkZWxheVxyXG5cdCAqIEByZXR1cm5zIHtudW1iZXJ9IC0gaW5kZXhcclxuXHQgKi9cclxuXHRhZGRGcmFtZSh1cmwsIHgsIHksIGRlbGF5KSB7XHJcblx0XHRpZiAoIXVybCkge1xyXG5cdFx0XHR0aHJvdyBuZXcgVHlwZUVycm9yKCk7XHJcblx0XHR9XHJcblx0XHRjb25zdCBpID0gdGhpcy5mcmFtZXMubGVuZ3RoO1xyXG5cdFx0bGV0IGZyYW1lID0gbmV3IEN1cnNvckFuaW1hdGlvbkZyYW1lKCk7XHJcblxyXG5cdFx0ZnJhbWUudXJsID0gdXJsO1xyXG5cdFx0ZnJhbWUueCA9IHggfCAwO1xyXG5cdFx0ZnJhbWUueSA9IHkgfCAwO1xyXG5cdFx0ZnJhbWUuZGVsYXkgPSBkZWxheSB8IDA7XHJcblxyXG5cdFx0dGhpcy5mcmFtZXMucHVzaChmcmFtZSk7XHJcblxyXG5cdFx0dGhpcy5kdXJhdGlvbiArPSBmcmFtZS5kZWxheTsgXHJcblxyXG5cdFx0cmV0dXJuIGk7XHJcblx0fVxyXG5cdGFzeW5jIGxvYWQodXJsKSB7XHJcblx0XHRsZXQgcmF3ID0gYXdhaXQgJGdldC5kYXRhKHVybCk7XHJcblxyXG5cdFx0Zm9yIChsZXQgaSA9IDAsIGZyYW1lID0gcmF3W2ldOyBmcmFtZTsgKytpLCBmcmFtZSA9IHJhd1tpXSkge1xyXG5cdFx0XHRsZXQgaW1nID0ge307XHJcblxyXG5cdFx0XHR0aGlzLmFkZEZyYW1lKFxyXG5cdFx0XHRcdFtcImltYWdlc1wiLCB1cmwsIGldLmpvaW4oXCIvXCIpLFxyXG5cdFx0XHRcdGZyYW1lLm9yaWdpbi54LFxyXG5cdFx0XHRcdGZyYW1lLm9yaWdpbi55LFxyXG5cdFx0XHRcdGZyYW1lLmRlbGF5XHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblx0fVxyXG59XHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEN1cnNvciAge1xyXG5cdGNvbnN0cnVjdG9yKC8qcmF3LCB1cmwqLykge1xyXG5cdFx0Ly8vKiogQHR5cGUge0FuaW1hdGlvbn0gKi9cclxuXHRcdC8vdGhpcy5hbmkgPSBudWxsO1xyXG5cdH1cclxuXHQvL2FzeW5jIGNyZWF0ZUFuaW1hdGlvbih1cmwpIHtcclxuXHQvL1x0bGV0IHJhdyA9IGF3YWl0ICRnZXQuZGF0YSh1cmwpO1xyXG5cdC8vXHR0aGlzLmFuaSA9IG5ldyBBbmltYXRpb24ocmF3LCB1cmwpO1xyXG5cdC8vXHRhd2FpdCB0aGlzLmFuaS5sb2FkKCk7XHJcblx0Ly99XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7Q3Vyc29yQW5pbWF0aW9uRGF0YX0gZGF0YVxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBzZWxlY3RvclxyXG5cdCAqIEBwYXJhbSB7c3RyaW5nfSBrZXl3b3JkXHJcblx0ICovXHJcblx0c3RhdGljIGNyZWF0ZVRvQ1NTKGRhdGEsIHNlbGVjdG9yLCBrZXl3b3JkKSB7XHJcblx0XHRjb25zdCBpZCA9IFwiQ3Vyc29yXCIgKyBNYXRoLnRydW5jKE1hdGgucmFuZG9tKCkgKiAweEZGRkZGRkZGKS50b1N0cmluZygxNik7XHJcblxyXG5cdFx0Y29uc3QgeyBmcmFtZXMsIGR1cmF0aW9uIH0gPSBkYXRhO1xyXG5cclxuXHRcdGxldCBjc3NUZXh0ID0gYCR7c2VsZWN0b3J9OmhvdmVyIHtcXG5gO1xyXG5cclxuXHRcdGNzc1RleHQgKz0gYGN1cnNvcjogdXJsKCR7ZnJhbWVzWzBdLnVybH0pICR7ZnJhbWVzWzBdLnh9ICR7ZnJhbWVzWzBdLnl9LCAke2tleXdvcmR9O1xcbmA7XHJcblxyXG5cdFx0aWYgKGR1cmF0aW9uKSB7XHJcblx0XHRcdGNzc1RleHQgKz0gYGFuaW1hdGlvbi1uYW1lOiAke2lkfV9rZXlmcmFtZXM7XFxuYDtcclxuXHRcdFx0Y3NzVGV4dCArPSBgYW5pbWF0aW9uLWR1cmF0aW9uOiAke2R1cmF0aW9ufW1zO1xcbmA7XHJcblx0XHRcdGNzc1RleHQgKz0gYGFuaW1hdGlvbi1pdGVyYXRpb24tY291bnQ6IGluZmluaXRlO1xcbmA7XHJcblx0XHRcdGNzc1RleHQgKz0gXCJ9XFxuXCI7XHJcblxyXG5cdFx0XHRsZXQgdHQgPSAwO1xyXG5cdFx0XHR7XHJcblx0XHRcdFx0Y3NzVGV4dCArPSBgQGtleWZyYW1lcyAke2lkfV9rZXlmcmFtZXMge1xcbmA7XHJcblxyXG5cdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgZnJhbWVzLmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0XHRjb25zdCBmcmFtZSA9IGZyYW1lc1tpXTtcclxuXHJcblx0XHRcdFx0XHRsZXQgc3RhcnQgPSBNYXRoLnRydW5jKCh0dCAvIGR1cmF0aW9uKSAqIDEwMCk7XHJcblxyXG5cdFx0XHRcdFx0Y3NzVGV4dCArPSBgJHtzdGFydH0lIHsgY3Vyc29yOiB1cmwoJHtmcmFtZXNbaV0udXJsfSkgJHtmcmFtZXNbaV0ueH0gJHtmcmFtZXNbaV0ueX0sICR7a2V5d29yZH07IH1cXG5gO1xyXG5cclxuXHRcdFx0XHRcdHR0ICs9IGZyYW1lLmRlbGF5O1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHQvL2Nzc1RleHQgKz0gYDEwMCUgeyBjdXJzb3I6IHVybCgke2ZyYW1lc1swXS51cmx9KSAke2ZyYW1lc1swXS54fSAke2ZyYW1lc1swXS55fTsgfVxcbmA7XHJcblxyXG5cdFx0XHRcdGNzc1RleHQgKz0gXCJ9XFxuXCI7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRjc3NUZXh0ICs9IFwifVwiO1xyXG5cdFx0fVxyXG5cdFx0XHJcblx0XHR2YXIgeCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJTVFlMRVwiKTtcclxuXHRcdHZhciB0ID0gZG9jdW1lbnQuY3JlYXRlVGV4dE5vZGUoY3NzVGV4dCk7XHJcblx0XHR4LmlkID0gaWQ7XHJcblx0XHR4LmFwcGVuZENoaWxkKHQpO1xyXG5cdFx0ZG9jdW1lbnQuaGVhZC5hcHBlbmRDaGlsZCh4KTtcclxuXHJcblx0XHRyZXR1cm4geDtcclxuXHR9XHJcbn1cclxuIiwiXHJcbmltcG9ydCB7IH0gZnJvbSAnLi9pbml0LmpzJztcclxuaW1wb3J0IHsgVmVjMiwgUmVjdGFuZ2xlIH0gZnJvbSAnLi9tYXRoLmpzJztcclxuaW1wb3J0IHsgSUdyYXBoLCBJUmVuZGVyZXIgfSBmcm9tICcuL0lSZW5kZXJlci5qcyc7XHJcbmltcG9ydCB7IGVuZ2luZSwgR3JhcGggfSBmcm9tICcuL0VuZ2luZS5qcyc7XHJcbmltcG9ydCB7IEFuaW1hdGlvbiB9IGZyb20gJy4vQW5pbWF0aW9uLmpzJztcclxuXHJcbmltcG9ydCB7IEdhbWVTdGF0ZU1hbmFnZXIgfSBmcm9tICcuL0dhbWVTdGF0ZS5qcyc7XHJcbmltcG9ydCB7IFNjZW5lTWFwIH0gZnJvbSAnLi9NYXAuanMnO1xyXG4vL2ltcG9ydCB7IFNjZW5lQ2hhcmFjdGVyIH0gZnJvbSAnLi9TY2VuZUNoYXJhY3Rlci5qcyc7XHJcblxyXG5pbXBvcnQgeyBFZmZlY3RNYW5hZ2VyIH0gZnJvbSBcIi4vU2tpbGwuanNcIjtcclxuaW1wb3J0IHsgfSBmcm9tIFwiLi9Nb2JTa2lsbC8yMzguRmFpcnlEdXN0LmpzXCI7XHJcblxyXG5pbXBvcnQgeyBkYW1hZ2VOdW1iZXJMYXllciB9IGZyb20gXCIuL1JlbmRlcmVyL0RhbWFnZU51bWJlci5qc1wiO1xyXG5pbXBvcnQgeyBzY2VuZVJlbmRlcmVyLCBTY2VuZVJlbmRlcmVyIH0gZnJvbSBcIi4vUmVuZGVyZXIvU2NlbmVSZW5kZXJlci5qc1wiO1xyXG5cclxuaW1wb3J0IHsgQ3Vyc29yLCBDdXJzb3JBbmltYXRpb25EYXRhIH0gZnJvbSBcIi4vQ3Vyc29yLmpzXCI7XHJcblxyXG5pbXBvcnQgeyBTY2VuZUNoYXJhY3RlciB9IGZyb20gXCIuL1NjZW5lQ2hhcmFjdGVyLmpzXCI7Ly9kZWJ1Z1xyXG5pbXBvcnQgeyBhcHAgYXMgZ0FwcCB9IGZyb20gXCIuLi9pbmRleC5qc1wiOy8vZGVidWdcclxuXHJcbmltcG9ydCB7IHVpQW5pbWF0aW9uTWFuYWdlciB9IGZyb20gJy4uL3VpL1VJQW5pbWF0aW9uTWFuYWdlci5qcyc7XHJcblxyXG5pbXBvcnQgeyBDbGllbnQgfSBmcm9tIFwiLi4vQ2xpZW50L0NsaWVudC5qc1wiO1xyXG5cclxuXHJcbnNjZW5lUmVuZGVyZXIuYWRkTGF5ZXJCYWNrKDEyKTtcclxuXHJcbndpbmRvdy5TQ1JFRU5fUFJJTlRMTiA9IGZ1bmN0aW9uIChnZXRUZXh0LCBnZXRWYWx1ZSkge1xyXG5cdGlmIChhcmd1bWVudHMubGVuZ3RoID09IDIpIHtcclxuXHRcdHdpbmRvdy5fU0NSRUVOX1BSSU5UTE4ucHVzaCh7IGdldFRleHQsIGdldFZhbHVlIH0pO1xyXG5cdH1cclxuXHRlbHNlIGlmIChhcmd1bWVudHMubGVuZ3RoID09IDEpIHtcclxuXHRcdHdpbmRvdy5fU0NSRUVOX1BSSU5UTE4ucHVzaChhcmd1bWVudHNbMF0pO1xyXG5cdH1cclxufVxyXG53aW5kb3cuX1NDUkVFTl9QUklOVExOID0gW107XHJcblxyXG52YXIgYW5pbWF0aW9uUmVxdWVzdElEID0gbnVsbDtcclxuXHJcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKFwicG9wc3RhdGVcIiwgZnVuY3Rpb24gKGUpIHtcclxuXHRHYW1lU3RhdGVNYW5hZ2VyLlBvcFN0YXRlKGUuc3RhdGUpO1xyXG59KTtcclxuXHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmZ1bmN0aW9uIGNyZWF0ZUN1cnNvcl9jbGlja2FibGUoKSB7XHJcblx0bGV0IGRhdGEgPSBuZXcgQ3Vyc29yQW5pbWF0aW9uRGF0YSgpO1xyXG5cclxuXHRsZXQgdGFzazEgPSBkYXRhLmFkZEZyYW1lRnJvbVVybChcIi9VSS9CYXNpYy9DdXJzb3IvMC8wXCIpLnRoZW4oZnVuY3Rpb24gKGkpIHtcclxuXHRcdGRhdGEuZnJhbWVzW2ldLmRlbGF5ID0gMjAwO1xyXG5cdH0pO1xyXG5cclxuXHRsZXQgdGFzazIgPSBkYXRhLmFkZEZyYW1lRnJvbVVybChcIi9VSS9CYXNpYy9DdXJzb3IvMTIvMFwiKS50aGVuKGZ1bmN0aW9uIChpKSB7XHJcblx0XHRkYXRhLmZyYW1lc1tpXS5kZWxheSA9IDIwMDtcclxuXHR9KTtcclxuXHJcblx0cmV0dXJuIFByb21pc2UuYWxsKFt0YXNrMSwgdGFzazJdKS50aGVuKGZ1bmN0aW9uICgpIHtcclxuXHRcdGRhdGEuZHVyYXRpb24gPSA0MDA7XHJcblxyXG5cdFx0Q3Vyc29yLmNyZWF0ZVRvQ1NTKGRhdGEsIFwiLnVpLWNsaWNrYWJsZVwiLCBcInBvaW50ZXJcIik7XHJcblx0fSk7XHJcbn1cclxuXHJcbmNyZWF0ZUN1cnNvcl9jbGlja2FibGUoKTtcclxuXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuLy9cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG5cclxuXHJcbi8qKlxyXG4gKiBAcGFyYW0ge0tleWJvYXJkRXZlbnR9IGVcclxuICovXHJcbndpbmRvdy5vbmtleWRvd24gPSBmdW5jdGlvbiAoZSkge1xyXG5cdGlmIChlLnRhcmdldCAhPSBkb2N1bWVudC5ib2R5KSB7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdGxldCBrID0gZS5rZXk7XHJcblxyXG5cdGlmIChrICE9IG51bGwgJiYgISRndi5pbnB1dF9rZXlEb3duW2tdKSB7XHJcblx0XHQkZ3YuaW5wdXRfa2V5RG93bltrXSAhPSBudWxsID8gKCsrJGd2LmlucHV0X2tleURvd25ba10pIDogKCRndi5pbnB1dF9rZXlEb3duW2tdID0gMSk7XHJcblx0fVxyXG5cclxuXHRpZiAoZS5jb2RlID09ICdTcGFjZScpIHtcclxuXHRcdCQoXCIjbV9pc19ydW5cIikuY2xpY2soKTtcclxuXHR9XHJcblx0aWYgKGUuY29kZSA9PSBcIkYyXCIpIHtcclxuXHRcdCRndi5tX2VkaXRvcl9tb2RlID0gISRndi5tX2VkaXRvcl9tb2RlO1xyXG5cdH1cclxufVxyXG5cclxud2luZG93Lm9ua2V5dXAgPSBmdW5jdGlvbiAoZSkge1xyXG5cdGlmIChlLnRhcmdldCAhPSBkb2N1bWVudC5ib2R5KSB7XHJcblx0XHRyZXR1cm47XHJcblx0fVxyXG5cdGxldCBrID0gZS5rZXk7XHJcblxyXG5cdGlmIChrICE9IG51bGwgJiYgJGd2LmlucHV0X2tleURvd25ba10pIHtcclxuXHRcdCRndi5pbnB1dF9rZXlEb3duW2tdID0gMDtcclxuXHRcdCRndi5pbnB1dF9rZXlVcFtrXSA9IDE7XHJcblx0fVxyXG59XHJcblxyXG5PYmplY3QuZGVmaW5lUHJvcGVydHkod2luZG93LCBcIiRtX2lzX3J1blwiLCB7XHJcblx0Z2V0OiBmdW5jdGlvbiAoKSB7XHJcblx0XHRyZXR1cm4gJChcIiNtX2lzX3J1blwiKS5hdHRyKFwiY2hlY2tlZFwiKTtcclxuXHR9LCBcclxuXHRzZXQ6IGZ1bmN0aW9uICh2YWx1ZSkge1xyXG5cdFx0JChcIiNtX2lzX3J1blwiKS5hdHRyKFwiY2hlY2tlZFwiLCAhdmFsdWUpO1xyXG5cdFx0JChcIiNtX2lzX3J1blwiKS5jbGljaygpO1xyXG5cdH1cclxufSk7XHJcblxyXG4vKipcclxuICogQHBhcmFtIHtNb3VzZUV2ZW50fSBlXHJcbiAqL1xyXG53aW5kb3cub25tb3VzZWRvd24gPSBmdW5jdGlvbiAoZSkge1xyXG5cdGlmICgkZ3YubV9lZGl0b3JfbW9kZSkge1xyXG5cdFx0aWYgKCFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJFZGl0b3JcIikpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRpZiAoZS53aGljaCA9PSAxKSB7XHJcblx0XHQkZ3YubW91c2VfZGwgPSAxO1xyXG5cdFx0JGd2Lm1vdXNlX3VsID0gMDtcclxuXHR9XHJcblx0ZWxzZSBpZiAoZS53aGljaCA9PSAyKSB7XHJcblx0XHQkZ3YubW91c2VfZG0gPSAxO1xyXG5cdFx0JGd2Lm1vdXNlX3VtID0gMDtcclxuXHR9XHJcblx0ZWxzZSBpZiAoZS53aGljaCA9PSAzKSB7XHJcblx0XHQkZ3YubW91c2VfZHIgPSAxO1xyXG5cdFx0JGd2Lm1vdXNlX3VyID0gMDtcclxuXHR9XHJcblx0JGd2Lm1vdXNlX3ggPSBlLnBhZ2VYO1xyXG5cdCRndi5tb3VzZV95ID0gZS5wYWdlWTtcclxufVxyXG5cclxuLyoqXHJcbiAqIEBwYXJhbSB7TW91c2VFdmVudH0gZVxyXG4gKi9cclxud2luZG93Lm9ubW91c2V1cCA9IGZ1bmN0aW9uIChlKSB7XHJcblx0aWYgKCRndi5tX2VkaXRvcl9tb2RlKSB7XHJcblx0XHRpZiAoIWUudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIkVkaXRvclwiKSkge1xyXG5cdFx0XHRyZXR1cm47XHJcblx0XHR9XHJcblx0fVxyXG5cdGlmIChlLndoaWNoID09IDEpIHtcclxuXHRcdCRndi5tb3VzZV9kbCA9IDA7XHJcblx0XHQkZ3YubW91c2VfdWwgPSAxO1xyXG5cdH1cclxuXHRlbHNlIGlmIChlLndoaWNoID09IDIpIHtcclxuXHRcdCRndi5tb3VzZV9kbSA9IDA7XHJcblx0XHQkZ3YubW91c2VfdW0gPSAxO1xyXG5cdH1cclxuXHRlbHNlIGlmIChlLndoaWNoID09IDMpIHtcclxuXHRcdCRndi5tb3VzZV9kciA9IDA7XHJcblx0XHQkZ3YubW91c2VfdXIgPSAxO1xyXG5cdH1cclxuXHQkZ3YubW91c2VfeCA9IGUucGFnZVg7XHJcblx0JGd2Lm1vdXNlX3kgPSBlLnBhZ2VZO1xyXG59XHJcblxyXG4vKipcclxuICogQHBhcmFtIHtNb3VzZUV2ZW50fSBlXHJcbiAqL1xyXG53aW5kb3cub25tb3VzZW1vdmUgPSBmdW5jdGlvbiAoZSkge1xyXG5cdGlmICgkZ3YubV9lZGl0b3JfbW9kZSkge1xyXG5cdFx0aWYgKCFlLnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJFZGl0b3JcIikpIHtcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdH1cclxuXHQkZ3YubW91c2VfeCA9IGUucGFnZVg7XHJcblx0JGd2Lm1vdXNlX3kgPSBlLnBhZ2VZO1xyXG5cdCRndi5tb3VzZV9tb3ZlID0gMTtcclxufVxyXG5cclxuLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vL1xyXG4vL1xyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcblxyXG5cclxuZXhwb3J0IGNsYXNzIEdhbWUge1xyXG5cdGNvbnN0cnVjdG9yKCkge1xyXG5cdFx0dGhpcy50aW1lciA9IDA7XHJcblx0XHR0aGlzLnRpbWVyXyA9IDA7XHJcblx0XHR0aGlzLl9kVGltZXIgPSAwO1xyXG5cdFx0dGhpcy5mcHNfYXJyID0gW107XHJcblx0XHR0aGlzLmZyYW1lX3NfYXJyID0gW107XHJcblx0XHRcclxuXHRcdC8vdGhpcy5jaGFyYSA9IG51bGw7XHJcblx0XHRcclxuXHRcdC8qKiBAdHlwZSB7U2NlbmVNYXB9ICovXHJcblx0XHR0aGlzLnNjZW5lX21hcCA9IG5ldyBTY2VuZU1hcCgpO1xyXG5cclxuXHRcdHdpbmRvdy5zY2VuZV9tYXAgPSB0aGlzLnNjZW5lX21hcDtcclxuXHRcdCRndi5zY2VuZV9tYXAgPSB3aW5kb3c7XHJcblxyXG5cdFx0c2NlbmVfbWFwLm9ubG9hZCA9IGZ1bmN0aW9uICgpIHtcclxuXHRcdFx0R2FtZVN0YXRlTWFuYWdlci5QdXNoU3RhdGUodGhpcywgd2luZG93LmNoYXJhKTtcclxuXHRcdH1cclxuXHRcdFxyXG5cdFx0dGhpcy5fbG9vcCA9IHRoaXMuX2xvb3AuYmluZCh0aGlzKTtcclxuXHRcdFxyXG5cdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtX2lzX3J1blwiKS5vbmNoYW5nZSA9IChmdW5jdGlvbiAoZSkge1xyXG5cdFx0XHR0aGlzLm1faXNfcnVuID0gZS50YXJnZXQuY2hlY2tlZCA/IHRydWUgOiBmYWxzZTtcclxuXHRcdFx0aWYgKHRoaXMubV9pc19ydW4pIHtcclxuXHRcdFx0XHRhbmltYXRpb25SZXF1ZXN0SUQgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUodGhpcy5fbG9vcCk7XHJcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJTY3JlZW5zaG90XCIpLmlubmVySFRNTCA9IFwiXCI7XHJcblx0XHRcdH1cclxuXHRcdH0pLmJpbmQodGhpcyk7XHJcblxyXG5cdFx0dGhpcy5fJG1vdmVWaWV3cG9ydFNwZWVkID0gMTA7Ly9kZWJ1Z1xyXG5cdH1cclxuXHRcclxuXHRtb3ZlVmlld3BvcnQoaW5Cb3VuZCkge1xyXG5cdFx0Y29uc3Qgc2NlbmVfbWFwID0gdGhpcy5zY2VuZV9tYXA7XHJcblxyXG5cdFx0Y29uc3Qgc3BlZWQgPSAkZ3YuaW5wdXRfa2V5RG93blsneiddID8gKHRoaXMuXyRtb3ZlVmlld3BvcnRTcGVlZCAqIDEwKSA6IHRoaXMuXyRtb3ZlVmlld3BvcnRTcGVlZDtcclxuXHJcblx0XHQvLyRndi5tX3ZpZXdSZWN0ID0gc2NlbmVfbWFwLnZpZXdBcmVhKG5ldyBWZWMyKCRndi5tX3ZpZXdSZWN0LmxlZnQsICRndi5tX3ZpZXdSZWN0LnRvcCkpO1xyXG5cclxuXHRcdGlmICgkZ3YuaW5wdXRfa2V5RG93blsnQXJyb3dMZWZ0J10gPiAwKSB7XHJcblx0XHRcdCRndi5tX3ZpZXdSZWN0LmxlZnQgLT0gc3BlZWQ7XHJcblx0XHR9XHJcblx0XHRpZiAoJGd2LmlucHV0X2tleURvd25bJ0Fycm93UmlnaHQnXSA+IDApIHtcclxuXHRcdFx0JGd2Lm1fdmlld1JlY3QubGVmdCArPSBzcGVlZDtcclxuXHRcdH1cclxuXHRcdGlmICgkZ3YuaW5wdXRfa2V5RG93blsnQXJyb3dVcCddID4gMCkge1xyXG5cdFx0XHQkZ3YubV92aWV3UmVjdC50b3AgLT0gc3BlZWQ7XHJcblx0XHR9XHJcblx0XHRpZiAoJGd2LmlucHV0X2tleURvd25bJ0Fycm93RG93biddID4gMCkge1xyXG5cdFx0XHQkZ3YubV92aWV3UmVjdC50b3AgKz0gc3BlZWQ7XHJcblx0XHR9XHJcblxyXG5cdFx0bGV0IHsgbGVmdCwgdG9wLCByaWdodCwgYm90dG9tIH0gPSBzY2VuZV9tYXAubWFwQm91bmQ7XHJcblxyXG5cdFx0aWYgKGluQm91bmQpIHtcclxuXHRcdFx0aWYgKCRndi5tX3ZpZXdSZWN0LmxlZnQgPCBsZWZ0KSB7XHJcblx0XHRcdFx0JGd2Lm1fdmlld1JlY3QubGVmdCA9IGxlZnQ7XHJcblx0XHRcdH1cclxuXHRcdFx0aWYgKCRndi5tX3ZpZXdSZWN0LnJpZ2h0ID4gcmlnaHQpIHtcclxuXHRcdFx0XHQkZ3YubV92aWV3UmVjdC5sZWZ0ID0gcmlnaHQgLSAkZ3YubV92aWV3UmVjdC53aWR0aDtcclxuXHRcdFx0fVxyXG5cdFx0XHRpZiAoJGd2Lm1fdmlld1JlY3QudG9wIDwgdG9wKSB7XHJcblx0XHRcdFx0JGd2Lm1fdmlld1JlY3QudG9wID0gdG9wO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICgkZ3YubV92aWV3UmVjdC5ib3R0b20gPiBib3R0b20pIHtcclxuXHRcdFx0XHQkZ3YubV92aWV3UmVjdC50b3AgPSBib3R0b20gLSAkZ3YubV92aWV3UmVjdC5oZWlnaHQ7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHR9XHJcblx0XHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtzdHJpbmd9IHNlcnZlclxyXG5cdCAqL1xyXG5cdGFzeW5jIF8kc3RhcnRDbGllbnQoc2VydmVyKSB7XHJcblx0XHRpZiAoc2NlbmVfbWFwKSB7XHJcblx0XHRcdGxldCBjbGllbnQgPSBuZXcgQ2xpZW50KCk7XHJcblx0XHRcdFxyXG5cdFx0XHR0cnkge1xyXG5cdFx0XHRcdGF3YWl0IGNsaWVudC5jb25uZWN0KHNlcnZlcik7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJzdGFydCBjbGllbnRcIik7XHJcblx0XHRcdH1cclxuXHRcdFx0Y2F0Y2ggKGVycikge1xyXG5cdFx0XHRcdGNvbnNvbGUuZXJyb3IoZXJyKTtcclxuXHRcdFx0XHRjb25zb2xlLmxvZyhcInN0YXJ0IG9mZmxpbmVcIik7XHJcblx0XHRcdFx0dGhpcy5fJHN0YXJ0X29mZmxpbmUoKTtcclxuXHRcdFx0XHRyZXR1cm47XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGdBcHAuY2xpZW50ID0gY2xpZW50O1xyXG5cdFx0XHRjbGllbnQuJHRlc3QoKTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdH1cclxuXHR9XHJcblx0XyRzdGFydF9vZmZsaW5lKCkge1xyXG5cdFx0bGV0IHBhcmFtcyA9IF9wYXJzZVVybFBhcmFtZXRlcigpO1xyXG5cdFx0bGV0IG1hcF9pZDtcclxuXHRcclxuXHRcdGlmIChwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nKSB7XHJcblx0XHRcdG1hcF9pZCA9IHBhcmFtc1tcIm1hcFwiXSB8fCB3aW5kb3cuREVGQVVMVF9NQVBfSUQ7XHJcblx0XHR9XHJcblx0XHRlbHNlIHtcclxuXHRcdFx0bWFwX2lkID0gcGFyYW1zW1wibWFwXCJdIHx8IFwiMDAwMDAwMDAwXCI7Ly80NTAwMDMwMDBcclxuXHRcdH1cclxuXHRcclxuXHRcdGxldCBjaGFyYV9jb2RlID0gcGFyYW1zW1wiY2hhcmFcIl0gfHwgXCJjLDAwMDAyMDEyLDAwMDEyMDEyLDAwMDI2NTA5fDAwMDI2NTA5LDAwMDM0ODczfDAwMDM0ODczLDAxMDUxNDI5LDAxMDcyMzkyXCI7XHJcblx0XHJcblx0XHRHYW1lU3RhdGVNYW5hZ2VyLlBvcFN0YXRlKHtcclxuXHRcdFx0bWFwX2lkOiBtYXBfaWQsXHJcblx0XHRcdGNoYXJhOiBjaGFyYV9jb2RlLFxyXG5cdFx0fSk7XHJcblx0fVxyXG5cclxuXHQvKiogQHR5cGUge2Jvb2xlYW59ICovXHJcblx0Z2V0IF9pc01hcFJlYWR5KCkge1xyXG5cdFx0Y29uc3Qgc2NlbmVfbWFwID0gdGhpcy5zY2VuZV9tYXA7XHJcblx0XHRyZXR1cm4gc2NlbmVfbWFwICYmIHNjZW5lX21hcC5pc0xvYWRlZCgpO1xyXG5cdH1cclxuXHRcclxuXHRhc3luYyBydW4oKSB7XHJcblx0XHRjb25zb2xlLmxvZyhcImJlZ2luIHJlbmRlclwiKTtcclxuXHRcdHRoaXMuX2xvb3AoMCk7Ly9zdGFydCByZW5kZXJcclxuXHR9XHJcblx0XHJcblx0YXN5bmMgZm9yY2VVcGRhdGVTY3JlZW4oKSB7XHJcblx0XHRjb25zdCBjaGFyYSA9IHRoaXMuY2hhcmE7XHJcblx0XHRcclxuXHRcdHRoaXMuX3VwZGF0ZVNjZW5lKDApO1xyXG5cdFx0XHJcblx0XHRjaGFyYS5yZW5kZXJlci5fX2ZvcmNlVXBkYXRlKDApO1xyXG5cdFx0XHJcblx0XHRpZiAodGhpcy5tX2lzX3J1bikge1xyXG5cdFx0XHRhd2FpdCBjaGFyYS5yZW5kZXJlci53YWl0TG9hZGVkKCk7XHJcblx0XHRcdGNoYXJhLnJlbmRlcmVyLl9fcmVxdWlyZV91cGRhdGUgPSB0cnVlOy8vdXBkYXRlIG9uY2VcclxuXHRcdFx0cmV0dXJuO1xyXG5cdFx0fVxyXG5cdFx0YXdhaXQgY2hhcmEucmVuZGVyZXIud2FpdExvYWRlZCgpO1xyXG5cdFx0YXdhaXQgY2hhcmEucmVuZGVyZXIuX3dhaXRGcmFtZVRleHR1cmVzTG9hZGVkKCk7XHJcblx0XHRhd2FpdCBJR3JhcGgud2FpdEFsbExvYWRlZCgpO1xyXG5cdFx0XHJcblx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcIlNjcmVlbnNob3RcIikuaW5uZXJIVE1MID0gXCJcIjtcclxuXHRcdFxyXG5cdFx0Y2hhcmEucmVuZGVyZXIuX19yZXF1aXJlX3VwZGF0ZSA9IHRydWU7Ly91cGRhdGUgb25jZVxyXG5cdFx0XHJcblx0XHR0aGlzLl9sb29wKDApO1xyXG5cdH1cclxuXHJcblx0LyoqXHJcblx0ICogQHBhcmFtIHtudW1iZXJ9IHN0YW1wXHJcblx0ICovXHJcblx0X2NhbGNGUFMoc3RhbXApIHtcclxuXHRcdHRyeSB7XHJcblx0XHRcdGlmICgodGhpcy50aW1lciAtIHRoaXMudGltZXJfKSA+PSAxMDAwKSB7XHJcblx0XHRcdFx0aWYgKHRoaXMuZnBzX2Fyci5sZW5ndGgpIHtcclxuXHRcdFx0XHRcdGxldCBzdW0gPSB0aGlzLmZwc19hcnIucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhICsgYjsgfSk7XHJcblx0XHRcdFx0XHRsZXQgYXZnID0gc3VtIC8gdGhpcy5mcHNfYXJyLmxlbmd0aDtcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0JGd2LkZQUyA9IGF2ZztcclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJGUFNcIikuaW5uZXJIVE1MID0gYXZnLnRvRml4ZWQoMik7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdGlmICh0aGlzLmZyYW1lX3NfYXJyLmxlbmd0aCkge1xyXG5cdFx0XHRcdFx0bGV0IHN1bSA9IHRoaXMuZnJhbWVfc19hcnIucmVkdWNlKGZ1bmN0aW9uIChhLCBiKSB7IHJldHVybiBhICsgYjsgfSk7XHJcblx0XHRcdFx0XHRsZXQgYXZnID0gc3VtIC8gdGhpcy5mcmFtZV9zX2Fyci5sZW5ndGg7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdCRndi5mcmFtZUNvdW50ID0gYXZnO1xyXG5cdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImZyYW1lXCIpLmlubmVySFRNTCA9IGF2Zy50b0ZpeGVkKDIpO1xyXG5cdFx0XHRcdH1cclxuXHJcblx0XHRcdFx0dGhpcy5mcmFtZV9zX2FyciA9IFtdO1xyXG5cdFx0XHRcdHRoaXMuZnBzX2FyciA9IFtdO1xyXG5cclxuXHRcdFx0XHR0aGlzLnRpbWVyXyA9IHRoaXMudGltZXI7XHJcblx0XHRcdH1cclxuXHRcdFx0ZWxzZSBpZiAoc3RhbXAgPiAwICYmIE51bWJlci5pc0Zpbml0ZShzdGFtcCkpIHtcclxuXHRcdFx0XHR0aGlzLmZwc19hcnIucHVzaCgxMDAwIC8gc3RhbXApO1xyXG5cdFx0XHRcdHRoaXMuZnJhbWVfc19hcnIucHVzaChzdGFtcCk7XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGNhdGNoIChleCkge1xyXG5cdFx0XHRkZWJ1Z2dlcjtcclxuXHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJGUFNcIikuaW5uZXJIVE1MID0gXCItXCI7XHJcblx0XHRcdGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiZnJhbWVcIikuaW5uZXJIVE1MID0gXCItXCI7XHJcblx0XHRcdHRoaXMuZnBzX2FyciA9IFtdO1xyXG5cdFx0XHR0aGlzLmZyYW1lX3NfYXJyID0gW107XHJcblx0XHR9XHJcblx0fVxyXG5cclxuXHRfcmVxdWVzdE5leHRGcmFtZSgpIHtcclxuXHRcdGlmICh0aGlzLm1faXNfcnVuKSB7XHJcblx0XHRcdGFuaW1hdGlvblJlcXVlc3RJRCA9IHJlcXVlc3RBbmltYXRpb25GcmFtZSh0aGlzLl9sb29wKTtcclxuXHRcdH1cclxuXHRcdGVsc2Uge1xyXG5cdFx0XHQvL2FzeW5jXHJcblx0XHRcdHNldFRpbWVvdXQoZnVuY3Rpb24gKCkge1xyXG5cdFx0XHRcdGxldCBlbGVtID0gbmV3IEltYWdlKCk7XHJcblx0XHRcdFx0ZWxlbS5zcmMgPSBlbmdpbmUuX2NhbnZhcy50b0RhdGFVUkwoKTtcclxuXHRcdFx0XHRlbmdpbmUuY3R4LmNsZWFyUmVjdCgwLCAwLCBlbmdpbmUuY3R4LndpZHRoLCBlbmdpbmUuY3R4LmhlaWdodCk7XHJcblx0XHRcdFx0ZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJTY3JlZW5zaG90XCIpLmFwcGVuZENoaWxkKGVsZW0pO1xyXG5cdFx0XHR9LCAwKTtcclxuXHRcdH1cclxuXHR9XHJcblxyXG5cdC8qKlxyXG5cdCAqIEBwYXJhbSB7bnVtYmVyfSBzdGFtcFxyXG5cdCAqL1xyXG5cdF91cGRhdGVTY2VuZShzdGFtcCkge1xyXG5cdFx0LyoqIEB0eXBlIHtTY2VuZUNoYXJhY3Rlcn0gKi9cclxuXHRcdGNvbnN0IGNoYXJhID0gdGhpcy5jaGFyYTtcclxuXHJcblx0XHQvKiogQHR5cGUge1NjZW5lQ2hhcmFjdGVyW119ICovXHJcblx0XHRjb25zdCBjaGFyYUxpc3QgPSB0aGlzLmNoYXJhTGlzdDtcclxuXHJcblx0XHR7XHJcblx0XHRcdGlmICh0aGlzLl9pc01hcFJlYWR5KSB7XHJcblx0XHRcdFx0c2NlbmVfbWFwLnVwZGF0ZShzdGFtcCk7Ly9pbmNsdWRlIHdvcmxkLnVwZGF0ZVxyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHQvLyBiZWZvcmUgd29ybGQudXBkYXRlID8/XHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY2hhcmFMaXN0Lmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0Y2hhcmFMaXN0W2ldLnVwZGF0ZShzdGFtcCk7XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdCRndi5TY2VuZU9iamVjdE1nci5VcGRhdGUoc3RhbXApO1xyXG5cclxuXHRcdFx0RWZmZWN0TWFuYWdlci5VcGRhdGUoc3RhbXApO1xyXG5cdFx0fVxyXG5cdFx0e1xyXG5cdFx0XHRjb25zdCBjbGllbnQgPSBnQXBwLmNsaWVudDsvL25vdCBvZmZsaW5lIGNoYXJhY3RlclxyXG5cclxuXHRcdFx0aWYgKGNsaWVudCAmJiBjbGllbnQuY2hhcmEpIHtcclxuXHRcdFx0XHQvKiogQHR5cGUge1NjZW5lQ2hhcmFjdGVyfSAqL1xyXG5cdFx0XHRcdGNvbnN0IGNoID0gY2xpZW50LmNoYXJhO1xyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGNoLiRlbWl0KHdpbmRvdy4kaW8pO1xyXG5cclxuXHRcdFx0XHRjaC4kcmVjTW92ZSgpO1xyXG5cdFx0XHR9XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHNjZW5lUmVuZGVyZXIudXBkYXRlKHN0YW1wKTtcclxuXHRcdFxyXG5cdFx0ZGFtYWdlTnVtYmVyTGF5ZXIudXBkYXRlKHN0YW1wKTtcclxuXHR9XHJcblx0XHJcblx0X3JlbmRlclNjZW5lKCkge1xyXG5cdFx0aWYgKHRoaXMuX2lzTWFwUmVhZHkpIHtcclxuXHRcdFx0dGhpcy5fcmVuZGVyX21hcF9yZWFkeSgpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZSB7XHJcblx0XHRcdHRoaXMuX3JlbmRlcl9tYXBfbG9hZGluZygpO1xyXG5cdFx0fVxyXG5cdH1cclxuXHRfcmVuZGVyX21hcF9yZWFkeSgpIHtcclxuXHRcdC8qKiBAdHlwZSB7U2NlbmVDaGFyYWN0ZXJ9ICovXHJcblx0XHRjb25zdCBjaGFyYSA9IHRoaXMuY2hhcmE7XHJcblxyXG5cdFx0LyoqIEB0eXBlIHtTY2VuZUNoYXJhY3RlcltdfSAqL1xyXG5cdFx0Y29uc3QgY2hhcmFMaXN0ID0gdGhpcy5jaGFyYUxpc3Q7XHJcblx0XHRcclxuXHRcdGVuZ2luZS5iZWdpblNjZW5lKCk7XHJcblx0XHR7XHJcblx0XHRcdGVuZ2luZS5sb2FkSWRlbnRpdHkoKTtcclxuXHRcdFx0ZW5naW5lLmNsZWFyRHJhd1NjcmVlbigpO1xyXG5cdFx0XHRcclxuXHRcdFx0JGd2Lm1fdmlld1JlY3Quc2l6ZSA9IGVuZ2luZS5zY3JlZW5fc2l6ZTtcclxuXHRcdFx0aWYgKCEkZ3YubV9lZGl0b3JfbW9kZSkge1xyXG5cdFx0XHRcdGlmIChjaGFyYSAmJiBjaGFyYS5yZW5kZXJlcikge1xyXG5cdFx0XHRcdFx0JGd2Lm1fdmlld1JlY3Quc2V0Q2VudGVyKGNoYXJhLnJlbmRlcmVyLngsIGNoYXJhLnJlbmRlcmVyLnkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIGlmIChzY2VuZV9tYXAuY29udHJvbGxlci5wbGF5ZXIpIHtcclxuXHRcdFx0XHRcdGNvbnN0IHBvcyA9IHNjZW5lX21hcC5jb250cm9sbGVyLnBsYXllci5nZXRQb3NpdGlvbigpO1xyXG5cdFx0XHRcdFx0Y29uc3QgcHggPSBNYXRoLnRydW5jKHBvcy54ICogJGd2LkNBTlZBU19TQ0FMRSArIDAuNSk7XHJcblx0XHRcdFx0XHRjb25zdCBweSA9IE1hdGgudHJ1bmMocG9zLnkgKiAkZ3YuQ0FOVkFTX1NDQUxFICsgMC41KTtcclxuXHRcdFx0XHRcdCRndi5tX3ZpZXdSZWN0LnNldENlbnRlcihweCwgcHkpO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKCRndi5tX2VkaXRvcl9tb2RlKSB7XHJcblx0XHRcdFx0dGhpcy5tb3ZlVmlld3BvcnQoZmFsc2UpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGlmICgkZ3YubV9pc19yZW5kZXJpbmdfbWFwKSB7XHJcblx0XHRcdFx0c2NlbmVfbWFwLmJlZ2luUmVuZGVyKGVuZ2luZSk7XHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0c2NlbmVfbWFwLnJlbmRlckJhY2tncm91bmQoZW5naW5lKTtcclxuXHRcdFx0XHRcdC8vaWYgKCRndi5tX2Rpc3BsYXlfbGlmZSAmJiBzY2VuZV9tYXAuX3Jhdy5pbmZvLm1pcnJvcl9Cb3R0b20pIHtcclxuXHRcdFx0XHRcdC8vXHRlbmdpbmUuY3R4LnNldFRyYW5zZm9ybSgxLCAwLCAwLCAxLCAwLCAwKTtcclxuXHRcdFx0XHRcdC8vXHRlbmdpbmUuY3R4LnRyYW5zbGF0ZShNYXRoLnRydW5jKC0kZ3YubV92aWV3UmVjdC54KSwgTWF0aC50cnVuYygtJGd2Lm1fdmlld1JlY3QueSkpO1xyXG5cdFx0XHRcdFx0Ly9cdGVuZ2luZS5jdHguc2NhbGUoMSwgLTEpO1xyXG5cdFx0XHRcdFx0Ly9cdGZvciAobGV0IGkgPSAwOyBpIDwgc2NlbmVfbWFwLmxheWVyZWRPYmplY3QubGVuZ3RoOyArK2kpIHtcclxuXHRcdFx0XHRcdC8vXHRcdHNjZW5lX21hcC5yZW5kZXJMaWZlKGVuZ2luZSwgaSk7XHJcblx0XHRcdFx0XHQvL1x0fVxyXG5cdFx0XHRcdFx0Ly99XHJcblx0XHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHNjZW5lX21hcC5sYXllcmVkT2JqZWN0Lmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0XHRcdHNjZW5lX21hcC5yZW5kZXJMYXllcmVkT2JqZWN0KGVuZ2luZSwgaSk7XHJcblx0XHRcdFx0XHRcdHNjZW5lX21hcC5yZW5kZXJMYXllcmVkVGlsZShlbmdpbmUsIGkpO1xyXG5cdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0c2NlbmVfbWFwLmFwcGx5Q2FtZXJhKGVuZ2luZSk7XHJcblx0XHRcdFx0XHRcdHtcclxuXHRcdFx0XHRcdFx0XHRpZiAoJGd2Lm1fZGlzcGxheV9vdGhlcl9wbGF5ZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGZvciAobGV0IGNoYXJhX2luZGV4ID0gMDsgY2hhcmFfaW5kZXggPCBjaGFyYUxpc3QubGVuZ3RoOyArK2NoYXJhX2luZGV4KSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGlmIChjaGFyYUxpc3RbY2hhcmFfaW5kZXhdID09IGNoYXJhKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdFx0Y29udGludWU7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdFx0ZWxzZSBpZiAoY2hhcmFMaXN0W2NoYXJhX2luZGV4XS4kbGF5ZXIgPT0gaSkge1xyXG5cdFx0XHRcdFx0XHRcdFx0XHRcdGNoYXJhTGlzdFtjaGFyYV9pbmRleF0ucmVuZGVyKGVuZ2luZSk7XHJcblx0XHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHR9XHJcblx0XHRcdFx0XHRcdFx0XHJcblx0XHRcdFx0XHRcdFx0c2NlbmVfbWFwLnJlbmRlckxpZmUoZW5naW5lLCBpKTtcclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHRpZiAoJGd2Lm1fZGlzcGxheV9wbGF5ZXIgJiYgY2hhcmEpIHtcclxuXHRcdFx0XHRcdFx0XHRcdGlmICgoY2hhcmEuJGxheWVyID09IG51bGwgfHwgY2hhcmEuJGxheWVyID09IGkpICYmIGNoYXJhLnJlbmRlcmVyKSB7XHJcblx0XHRcdFx0XHRcdFx0XHRcdGNoYXJhLnJlbmRlcihlbmdpbmUpO1xyXG5cdFx0XHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdFx0XHQkZ3YuU2NlbmVPYmplY3RNZ3IuUmVuZGVyTGF5ZXIoZW5naW5lLCBpKTtcclxuXHRcdFx0XHRcdFx0XHQvL1xyXG5cdFx0XHRcdFx0XHRcdHNjZW5lUmVuZGVyZXIucmVuZGVyTGF5ZXIoZW5naW5lLCBpKTtcclxuXHRcdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdFx0c2NlbmVfbWFwLmFwcGx5Q2FtZXJhKGVuZ2luZSk7XHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdGZvciAobGV0IGkgPSBzY2VuZV9tYXAubGF5ZXJlZE9iamVjdC5sZW5ndGg7IGkgPCAxMjsgKytpKSB7XHJcblx0XHRcdFx0XHRcdFx0JGd2LlNjZW5lT2JqZWN0TWdyLlJlbmRlckxheWVyKGVuZ2luZSwgaSk7XHJcblx0XHRcdFx0XHRcdFx0Ly9cclxuXHRcdFx0XHRcdFx0XHRzY2VuZVJlbmRlcmVyLnJlbmRlckxheWVyKGVuZ2luZSwgaSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0c2NlbmVfbWFwLmVuZFJlbmRlcihlbmdpbmUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdC8vVE9ETzogbGF5ZXJcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRmb3IgKGxldCBpID0gMDsgaSA8IHNjZW5lUmVuZGVyZXIubGF5ZXJzLmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0XHRzY2VuZVJlbmRlcmVyLnJlbmRlckxheWVyKGVuZ2luZSwgaSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdFxyXG5cdFx0XHRcdGlmICgkZ3YubV9kaXNwbGF5X290aGVyX3BsYXllciB8fCAkZ3YubV9kaXNwbGF5X3BsYXllcikge1xyXG5cdFx0XHRcdFx0c2NlbmVfbWFwLmFwcGx5Q2FtZXJhKGVuZ2luZSk7XHJcblx0XHRcdFx0XHRcclxuXHRcdFx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY2hhcmFMaXN0Lmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0XHRcdGlmIChjaGFyYUxpc3RbaV0gIT0gY2hhcmEgJiYgJGd2Lm1fZGlzcGxheV9vdGhlcl9wbGF5ZXIpIHtcclxuXHRcdFx0XHRcdFx0XHRjaGFyYUxpc3RbaV0ucmVuZGVyKGVuZ2luZSk7XHJcblx0XHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdGlmICgkZ3YubV9kaXNwbGF5X3BsYXllciAmJiBjaGFyYSkge1xyXG5cdFx0XHRcdFx0XHRjaGFyYS5yZW5kZXIoZW5naW5lKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0RWZmZWN0TWFuYWdlci5SZW5kZXIoZW5naW5lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHJcblx0XHRcdGRhbWFnZU51bWJlckxheWVyLnJlbmRlcihlbmdpbmUpO1xyXG5cclxuXHRcdFx0Zm9yIChsZXQgaSA9IDA7IGkgPCBjaGFyYUxpc3QubGVuZ3RoOyArK2kpIHtcclxuXHRcdFx0XHRjaGFyYUxpc3RbaV0uXyRkcmF3TmFtZShlbmdpbmUpO1xyXG5cdFx0XHR9XHJcblx0XHRcdGZvciAobGV0IGkgPSAwOyBpIDwgY2hhcmFMaXN0Lmxlbmd0aDsgKytpKSB7XHJcblx0XHRcdFx0Y2hhcmFMaXN0W2ldLl8kZHJhd0NoYXRCYWxsb29uKGVuZ2luZSk7XHJcblx0XHRcdH1cclxuXHRcdFx0XHJcblx0XHRcdGlmICgkZ3YubV9pc19yZW5kZXJpbmdfbWFwKSB7XHJcblx0XHRcdFx0c2NlbmVfbWFwLmJlZ2luUmVuZGVyKGVuZ2luZSk7XHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0c2NlbmVfbWFwLmFwcGx5Q2FtZXJhKGVuZ2luZSk7XHJcblx0XHRcdFx0XHR7XHJcblx0XHRcdFx0XHRcdHNjZW5lX21hcC5yZW5kZXJQb3J0YWwoZW5naW5lKTtcclxuXHRcdFx0XHRcdH1cclxuXHRcdFx0XHRcdFxyXG5cdFx0XHRcdFx0c2NlbmVfbWFwLnJlbmRlckZyb250Z3JvdW5kKGVuZ2luZSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHRcdHNjZW5lX21hcC5lbmRSZW5kZXIoZW5naW5lKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRzY2VuZV9tYXAucmVuZGVyUGFydGljbGUoZW5naW5lKTtcclxuXHJcblx0XHRcdFx0c2NlbmVfbWFwLmFwcGx5Q2FtZXJhKGVuZ2luZSk7XHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0RWZmZWN0TWFuYWdlci5SZW5kZXIoZW5naW5lKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0ZW5naW5lLmxvYWRJZGVudGl0eSgpO1xyXG5cdFx0XHR9XHJcblx0XHRcdFxyXG5cdFx0XHR7XHJcblx0XHRcdFx0c2NlbmVfbWFwLmFwcGx5Q2FtZXJhKGVuZ2luZSk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYgKCRndi5tX2Rpc3BsYXlfZGVidWdfaW5mbykge1xyXG5cdFx0XHRcdFx0LyoqIEB0eXBlIHtDYW52YXNSZW5kZXJpbmdDb250ZXh0MkR9ICovXHJcblx0XHRcdFx0XHRjb25zdCBjdHggPSBlbmdpbmUuY3R4O1xyXG5cdFx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0XHRjdHguYmVnaW5QYXRoKCk7XHJcblxyXG5cdFx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gXCJ3aGl0ZVwiO1xyXG5cdFx0XHRcdFx0XHRjdHguZmlsbFJlY3QoMCwgMCwgOTYsIDUwKTtcclxuXHJcblx0XHRcdFx0XHRcdGN0eC5maWxsU3R5bGUgPSBcImJsYWNrXCI7XHJcblx0XHRcdFx0XHRcdGN0eC5maWxsVGV4dChcIm1hcCBvcmlnaW5cIiwgNSwgMTQsIDk2KTtcclxuXHJcblx0XHRcdFx0XHRcdGN0eC5maWxsVGV4dChcInZpZXcteDogXCIgKyAkZ3YubV92aWV3UmVjdC54LnRvRml4ZWQoMCksIDUsIDMwLCA5Nik7XHJcblxyXG5cdFx0XHRcdFx0XHRjdHguZmlsbFRleHQoXCJ2aWV3LXk6IFwiICsgJGd2Lm1fdmlld1JlY3QueS50b0ZpeGVkKDApLCA1LCA0NiwgOTYpO1xyXG5cdFx0XHRcdFx0fVxyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRzY2VuZV9tYXAuY29udHJvbGxlci5yZW5kZXIoZW5naW5lKTtcclxuXHRcdFx0XHRcclxuXHRcdFx0XHRlbmdpbmUubG9hZElkZW50aXR5KCk7XHJcblx0XHRcdFx0XHJcblx0XHRcdFx0aWYgKCRndi5tX2Rpc3BsYXlfZGVidWdfaW5mbykge1xyXG5cdFx0XHRcdFx0dGhpcy5fcmVuZGVyX2RlYnVnX2luZm8oKTtcclxuXHRcdFx0XHR9XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGVuZ2luZS5lbmRTY2VuZSgpO1xyXG5cdH1cclxuXHRfcmVuZGVyX21hcF9sb2FkaW5nKCkge1xyXG5cdFx0Y29uc3QgY3R4ID0gZW5naW5lLmN0eDtcclxuXHRcdGNvbnN0IHNjcmVlbl93aWR0aCA9IGVuZ2luZS5zY3JlZW5fc2l6ZS54O1xyXG5cdFx0Y29uc3Qgc2NyZWVuX2hlaWdodCA9IGVuZ2luZS5zY3JlZW5fc2l6ZS55O1xyXG5cdFx0Y29uc3Qgc2NyX2h3ID0gc2NyZWVuX3dpZHRoICogMC41O1xyXG5cdFx0Y29uc3Qgc2NyX2hoID0gc2NyZWVuX2hlaWdodCAqIDAuNTtcclxuXHRcdFxyXG5cdFx0Y3R4LmZvbnQgPSBcIjJlbSDlvq7ou5/mraPpu5Hpq5RcIjtcclxuXHRcdGN0eC50ZXh0QWxpZ24gPSBcImNlbnRlclwiO1xyXG5cdFx0Y3R4LnRleHRCYXNlbGluZSA9IFwiY2VudGVyXCI7XHJcblx0XHRcclxuXHRcdGN0eC5maWxsU3R5bGUgPSBcIndoaXRlXCI7XHJcblx0XHRjdHguZmlsbFRleHQoXCJsb2FkaW5nLi4uXCIsIHNjcl9odywgc2NyX2hoKTtcclxuXHRcdFxyXG5cdFx0Y3R4LnN0cm9rZVN0eWxlID0gXCJibGFja1wiO1xyXG5cdFx0Y3R4LmZpbGxUZXh0KFwibG9hZGluZy4uLlwiLCBzY3JfaHcsIHNjcl9oaCk7XHJcblx0fVxyXG5cclxuXHRfcmVuZGVyX2RlYnVnX2luZm8oKSB7XHJcblx0XHRpZiAoIShzY2VuZV9tYXAuY29udHJvbGxlciAmJiBzY2VuZV9tYXAuY29udHJvbGxlci5wbGF5ZXIpKSB7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHRcdC8qKiBAdHlwZSB7Q2FudmFzUmVuZGVyaW5nQ29udGV4dDJEfSAqL1xyXG5cdFx0Y29uc3QgY3R4ID0gZW5naW5lLmN0eDtcclxuXHJcblx0XHRjb25zdCB0YSA9IGN0eC50ZXh0QWxpZ24sIHRiID0gY3R4LnRleHRCYXNlbGluZSwgbHcgPSBjdHgubGluZVdpZHRoO1xyXG5cdFx0Y3R4LnRleHRCYXNlbGluZSA9IFwidG9wXCI7XHJcblx0XHRjdHgubGluZVdpZHRoID0gMi41O1xyXG5cdFx0Y3R4LnN0cm9rZVN0eWxlID0gXCIjMDAwXCI7XHJcblx0XHRsZXQgeCA9IDQwMCwgeSA9IDU7XHJcblx0XHRmb3IgKGxldCBsaW5lIG9mIHdpbmRvdy5fU0NSRUVOX1BSSU5UTE4pIHtcclxuXHRcdFx0Y29uc3QgdmFsID0gbGluZS5nZXRWYWx1ZSgpO1xyXG5cdFx0XHRjb25zdCB0ZXh0ID0gbGluZS5nZXRUZXh0KCk7XHJcblxyXG5cdFx0XHRjdHguZmlsbFN0eWxlID0gXCIjRkZGXCI7XHJcblx0XHRcdHtcclxuXHRcdFx0XHRjdHgudGV4dEFsaWduID0gXCJyaWdodFwiO1xyXG5cdFx0XHRcdGN0eC5zdHJva2VUZXh0KHRleHQsIHggLSAyLCB5KTtcclxuXHRcdFx0XHRjdHguZmlsbFRleHQodGV4dCwgeCAtIDIsIHkpO1xyXG5cclxuXHRcdFx0XHRjdHgudGV4dEFsaWduID0gXCJjZW50ZXJcIjtcclxuXHRcdFx0XHRjdHguc3Ryb2tlVGV4dChcIjpcIiwgeCwgeSk7XHJcblx0XHRcdFx0Y3R4LmZpbGxUZXh0KFwiOlwiLCB4LCB5KTtcclxuXHJcblx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9IFwibGVmdFwiO1xyXG5cdFx0XHRcdGN0eC5zdHJva2VUZXh0KHZhbCwgeCArIDIsIHkpO1xyXG5cdFx0XHRcdGN0eC5maWxsVGV4dCh2YWwsIHggKyAyLCB5KTtcclxuXHRcdFx0fVxyXG5cclxuXHRcdFx0aWYgKFwiX3ZhbFwiIGluIGxpbmUpIHtcclxuXHRcdFx0XHRsZXQgX3ZhbDtcclxuXHRcdFx0XHRpZiAobGluZS5fdmFsICE9IHZhbCkge1xyXG5cdFx0XHRcdFx0X3ZhbCA9IGxpbmUuX3ZhbDsvL2Rpc3BsYXkgbmV3IHZhbHVlXHJcblx0XHRcdFx0XHRsaW5lLl9fdmFsID0gbGluZS5fdmFsO1xyXG5cdFx0XHRcdFx0bGluZS5fdmFsID0gdmFsO1xyXG5cdFx0XHRcdH1cclxuXHRcdFx0XHRlbHNlIHtcclxuXHRcdFx0XHRcdF92YWwgPSBsaW5lLl9fdmFsOy8vZGlzcGxheSBvbGQgdmFsdWVcclxuXHRcdFx0XHR9XHJcblx0XHRcdFx0aWYgKF92YWwgIT0gdmFsKSB7XHJcblx0XHRcdFx0XHRjdHguZmlsbFN0eWxlID0gXCIjMEZGXCI7XHJcblx0XHRcdFx0fVxyXG5cclxuXHRcdFx0XHRjdHguZmlsbFN0eWxlID0gXCIjRkZGXCI7XHJcblx0XHRcdFx0e1xyXG5cdFx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9IFwicmlnaHRcIjtcclxuXHRcdFx0XHRcdGN0eC5zdHJva2VUZXh0KHRleHQsIHggLSAyICsgMjAwLCB5KTtcclxuXHRcdFx0XHRcdGN0eC5maWxsVGV4dCh0ZXh0LCB4IC0gMiArIDIwMCwgeSk7XHJcblxyXG5cdFx0XHRcdFx0Y3R4LnRleHRBbGlnbiA9IFwiY2VudGVyXCI7XHJcblx0XHRcdFx0XHRjdHguc3Ryb2tlVGV4dChcIjpcIiwgeCArIDIwMCwgeSk7XHJcblx0XHRcdFx0XHRjdHguZmlsbFRleHQoXCI6XCIsIHggKyAyMDAsIHkpO1xyXG5cclxuXHRcdFx0XHRcdGN0eC50ZXh0QWxpZ24gPSBcImxlZnRcIjtcclxuXHRcdFx0XHRcdGN0eC5zdHJva2VUZXh0KF92YWwsIHggKyAyICsgMjAwLCB5KTtcclxuXHRcdFx0XHRcdGN0eC5maWxsVGV4dChfdmFsLCB4ICsgMiArIDIwMCwgeSk7XHJcblx0XHRcdFx0fVxyXG5cdFx0XHR9XHJcblx0XHRcdGVsc2Uge1xyXG5cdFx0XHRcdGxpbmUuX192YWwgPSB2YWw7XHJcblx0XHRcdFx0bGluZS5fdmFsID0gdmFsO1xyXG5cdFx0XHR9XHJcblxyXG5cdFx0XHR5ICs9IDE2O1xyXG5cdFx0fVxyXG5cdFx0Y3R4LnRleHRBbGlnbiA9IHRhO1xyXG5cdFx0Y3R4LnRleHRCYXNlbGluZSA9IHRiO1xyXG5cdFx0Y3R4LmxpbmVXaWR0aCA9IGx3O1xyXG5cdH1cclxuXHRcclxuXHQvKipcclxuXHQgKiBAcGFyYW0ge0RPTUhpZ2hSZXNUaW1lU3RhbXB9IHRpbWVTdGFtcFxyXG5cdCAqL1xyXG5cdF9sb29wKHRpbWVTdGFtcCkge1xyXG5cdFx0Y29uc3Qgc2NlbmVfbWFwID0gdGhpcy5zY2VuZV9tYXA7XHJcblx0XHRjb25zdCBzdGFtcCA9IHRpbWVTdGFtcCAtIHRoaXMudGltZXI7XHJcblx0XHRcclxuXHRcdHRoaXMudGltZXIgPSB0aW1lU3RhbXA7XHJcblxyXG5cdFx0dGhpcy5fcmVxdWVzdE5leHRGcmFtZSgpO1xyXG5cclxuXHRcdHRoaXMuX2NhbGNGUFMoc3RhbXApO1xyXG5cdFxyXG5cdFx0dGhpcy5fdXBkYXRlU2NlbmUoc3RhbXApO1xyXG5cclxuXHRcdHRoaXMuX3JlbmRlclNjZW5lKCk7XHJcblx0XHRcclxuXHRcdGZvciAobGV0IGkgaW4gJGd2LmlucHV0X2tleURvd24pIHtcclxuXHRcdFx0aWYgKCRndi5pbnB1dF9rZXlEb3duW2ldID4gMCkge1xyXG5cdFx0XHRcdCsrJGd2LmlucHV0X2tleURvd25baV07XHJcblx0XHRcdH1cclxuXHRcdH1cclxuXHRcdGZvciAobGV0IGkgaW4gJGd2LmlucHV0X2tleVVwKSB7XHJcblx0XHRcdCRndi5pbnB1dF9rZXlVcFtpXSA9IDA7XHJcblx0XHR9XHJcblx0XHRcclxuXHRcdHVpQW5pbWF0aW9uTWFuYWdlci51cGRhdGUoc3RhbXApO1xyXG5cdH1cclxuXHRcclxuXHRnZXQgY2hhcmEoKSB7XHJcblx0XHRyZXR1cm4gd2luZG93LmNoYXJhO1xyXG5cdH1cclxuXHQvL3NldCBjaGFyYSh2YWx1ZSkge1xyXG5cdC8vXHR3aW5kb3cuY2hhcmEgPSB2YWx1ZTtcclxuXHQvL31cclxuXHJcblx0Z2V0IGNoYXJhTGlzdCgpIHtcclxuXHRcdHJldHVybiBnQXBwLnN0b3JlLnN0YXRlLmNoYXJhTGlzdDtcclxuXHR9XHJcblx0XHJcblx0Z2V0IG1faXNfcnVuKCkge1xyXG5cdFx0cmV0dXJuIHdpbmRvdy5tX2lzX3J1bjtcclxuXHR9XHJcblx0c2V0IG1faXNfcnVuKHZhbHVlKSB7XHJcblx0XHR3aW5kb3cubV9pc19ydW4gPSB2YWx1ZTtcclxuXHR9XHJcbn1cclxuXHJcblxyXG4vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vXHJcbi8vXHJcbi8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy8vLy9cclxuXHJcbmZ1bmN0aW9uIF9wYXJzZVVybFBhcmFtZXRlcigpIHtcclxuXHRsZXQgc1BhZ2VVUkwgPSBkZWNvZGVVUklDb21wb25lbnQod2luZG93LmxvY2F0aW9uLnNlYXJjaC5zdWJzdHJpbmcoMSkpO1xyXG5cdGxldCBzVVJMVmFyaWFibGVzID0gc1BhZ2VVUkwuc3BsaXQoXCImXCIpO1xyXG5cdGxldCBwYXJhbXMgPSB7fTtcclxuXHJcblx0Zm9yIChsZXQgaSA9IDA7IGkgPCBzVVJMVmFyaWFibGVzLmxlbmd0aDsgKytpKSB7XHJcblx0XHRsZXQgc1BhcmFtZXRlciA9IHNVUkxWYXJpYWJsZXNbaV0uc3BsaXQoXCI9XCIpO1xyXG5cclxuXHRcdHBhcmFtc1tzUGFyYW1ldGVyWzBdXSA9IHNQYXJhbWV0ZXJbMV07XHJcblx0fVxyXG5cclxuXHRyZXR1cm4gcGFyYW1zO1xyXG59O1xyXG5cclxuIl0sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7O0FBQUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBSUE7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxlQUlBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTs7O0FDL1dBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOzs7Ozs7Ozs7Ozs7Ozs7QUNuR0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7OztBQ2hKQTtBQUFBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxTQUVBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Iiwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///483\n')}}]);